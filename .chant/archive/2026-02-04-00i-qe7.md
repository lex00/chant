---
type: code
status: completed
target_files:
- src/repository/mod.rs
- src/repository/spec_repository.rs
branch: chant/2026-02-04-00i-qe7
commits:
- b54da9b
completed_at: 2026-02-04T21:51:14Z
model: sonnet
---
# Create SpecRepository trait and FileSpecRepository

## Problem

`src/spec.rs` has direct filesystem I/O making it hard to unit test. Need a trait abstraction.

## Solution

Create `src/repository/` module with a `SpecRepository` trait and `FileSpecRepository` implementation wrapping existing `src/spec.rs` functions.

## Acceptance Criteria

- [x] Create `src/repository/mod.rs` that exports `spec_repository` module
- [x] Create `src/repository/spec_repository.rs` with `SpecRepository` trait defining: `load(&self, id: &str) -> Result<Spec>`, `save(&self, spec: &Spec) -> Result<()>`, `list_all(&self) -> Result<Vec<Spec>>`
- [x] Create `FileSpecRepository` struct implementing `SpecRepository` that delegates to existing `src/spec.rs` functions
- [x] Add `pub mod repository;` to `src/lib.rs`
- [x] Run `cargo build` and confirm zero errors

## Agent Output

2026-02-04T21:51:14Z

```
I'll implement the SpecRepository trait and FileSpecRepository implementation.
## Summary

Created `src/repository/` module with `SpecRepository` trait and `FileSpecRepository` implementation.

- Created `src/repository/mod.rs` exporting `spec_repository` module
- Created `src/repository/spec_repository.rs` with trait and implementation
- `SpecRepository` trait defines `load()`, `save()`, and `list_all()` methods
- `FileSpecRepository` delegates to existing `Spec::load()`, `Spec::save()`, and `load_all_specs()` functions
- Added `pub mod repository;` to `src/lib.rs`
- Verified with `cargo build` and `cargo clippy` - zero errors```
