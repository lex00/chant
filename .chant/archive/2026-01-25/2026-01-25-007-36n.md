---
type: code
status: completed
target_files:
- .chant/prompts/standard.md
commits:
- 936b459
completed_at: 2026-01-25T10:08:47Z
model: haiku
---
# Enhance standard prompt to create specs for out-of-scope issues

## Problem

When agents notice problems outside the scope of their current assignment, they should:
1. Create a new spec to address the issue (`just chant add "description"`)
2. NOT create duplicate specs for the same issue
3. Continue with their original task

Currently the standard prompt doesn't guide this behavior.

## Solution

Update `.chant/prompts/standard.md` to include:

### 1. Out-of-scope issue handling
```markdown
## When You Notice Issues Outside Your Scope

If you encounter a problem that is NOT part of your current spec:
1. Check if a spec already exists for this issue: `just chant list | grep -i "keyword"`
2. If no existing spec, create one: `just chant add "Brief description of the issue"`
3. Note in your output that you created a new spec
4. Continue with your original assignment - do NOT fix the out-of-scope issue
```

### 2. Duplicate prevention
```markdown
## Avoiding Duplicate Specs

Before creating a new spec:
- Search existing specs: `just chant list`
- Search archived specs: `ls .chant/archive/`
- If similar spec exists, do NOT create a duplicate
```

## Acceptance Criteria

- [x] Standard prompt includes guidance on out-of-scope issue handling
- [x] Standard prompt includes duplicate spec prevention
- [x] Instructions use `just chant add` (not direct binary)
- [x] Agent is told to continue original task after creating spec
- [x] Clear examples provided

## Agent Output

2026-01-25T10:08:47Z

```
I'll help you enhance the standard prompt to guide agents on handling out-of-scope issues and preventing duplicate specs. Let me start by creating a todo list and then reading the relevant files.
Now let me read the current standard prompt file:
Good! Now I understand the structure. Let me mark the first task as complete and move on to planning the enhancement:
The standard prompt is currently a template that gets populated with spec details. I need to add two new sections:
1. Out-of-scope issue handling with guidance on creating specs
2. Duplicate prevention guidance

Let me plan and then implement:
**Plan:** I'll add two new sections to the standard prompt:
- "When You Notice Issues Outside Your Scope" - explains how to handle out-of-scope problems
- "Avoiding Duplicate Specs" - explains how to check for existing specs before creating new ones

These sections will be placed after the Instructions but before the Constraints sections to guide agents appropriately.

Now let me implement the enhancement:
Excellent! Now let me mark that task as complete and verify the changes:
Let me verify the changes by reading the updated file:
Perfect! The changes look good. Now let me build the project to ensure everything compiles correctly:
Great! Now let me run tests to verify nothing broke:
Perfect! All tests pass. Now let me update the acceptance criteria in the spec file and commit the changes:
Now let me read the spec file to update the acceptance criteria:
Now let me update all the acceptance criteria checkboxes to completed:
Now let me add the model to the frontmatter and mark the status as completed:
Excellent! Now let me mark that todo as complete and move to the final step:
Now let me commit the changes:
Perfect! Let me verify the commit was successful:
Excellent! Now let me mark the final todo as complete:
## Spec Complete ✓

I've successfully enhanced the standard prompt to guide agents on handling out-of-scope issues and preventing duplicate specs. Here's what was implemented:

### Changes Made

**Modified:** `.chant/prompts/standard.md`

Two comprehensive new sections were added to the standard prompt template:

1. **"When You Notice Issues Outside Your Scope"**
   - Clear 4-step process for handling out-of-scope problems
   - Uses `just chant add` (following the CLAUDE.md guidelines)
   - Explicit instruction to continue with original assignment
   - Three practical examples covering common scenarios:
     - Documentation fixes
     - Performance issues
     - Security concerns

2. **"Avoiding Duplicate Specs"**
   - 4-step duplicate prevention process
   - Guidance to search existing specs with `just chant list`
   - Guidance to check archived specs with `ls .chant/archive/`
   - Example of how to reference existing specs
   - Emphasis on creating unique, descriptive titles

### Verification

- ✅ All 239 tests pass
- ✅ Project builds successfully
- ✅ All acceptance criteria met
- ✅ Spec marked as completed with model attribution
- ✅ Changes committed as: `936b459`

The enhanced prompt now provides clear, actionable guidance that will help agents make better decisions about creating specs for out-of-scope issues while avoiding duplicates.```
