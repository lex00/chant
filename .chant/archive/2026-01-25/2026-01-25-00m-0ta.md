---
type: code
status: completed
target_files:
- .github/workflows/release.yml
commits:
- b7b6a2b
completed_at: 2026-01-25T11:39:48Z
model: haiku
---
# Fix Windows binary double .exe extension in release workflow

## Problem

Windows release artifact is named `chant-windows-x86_64.exe.exe` (double extension).

**Root cause:** `asset_name` already includes `.exe` but the workflow appends another:

```yaml
# Line 34: asset_name already has .exe
asset_name: chant-windows-x86_64.exe

# Line 67: adds ANOTHER .exe
cp target/${{ matrix.target }}/release/chant.exe ${{ matrix.asset_name }}.exe

# Line 78: same issue
gh release upload ${{ github.ref_name }} ${{ matrix.asset_name }}.exe
```

## Fix

Remove the extra `.exe` suffix in the Windows-specific branches. Use `${{ matrix.asset_name }}` directly since it already contains the correct extension.

**Lines 66-70:**
```yaml
run: |
  if [ "${{ matrix.os }}" = "windows-latest" ]; then
    cp target/${{ matrix.target }}/release/chant.exe ${{ matrix.asset_name }}
  else
    cp target/${{ matrix.target }}/release/chant ${{ matrix.asset_name }}
  fi
```

**Lines 77-81:**
```yaml
run: |
  if [ "${{ matrix.os }}" = "windows-latest" ]; then
    gh release upload ${{ github.ref_name }} ${{ matrix.asset_name }}
  else
    gh release upload ${{ github.ref_name }} ${{ matrix.asset_name }}
  fi
```

Or simplify since both branches now do the same thing:
```yaml
run: |
  cp target/${{ matrix.target }}/release/${{ matrix.bin_name }} ${{ matrix.asset_name }}

run: |
  gh release upload ${{ github.ref_name }} ${{ matrix.asset_name }}
```

## Acceptance Criteria

- [x] Fix double `.exe` extension in Windows artifact
- [x] Simplify workflow by removing unnecessary OS conditionals
- [x] Result: `chant-windows-x86_64.exe` (single extension)

## Agent Output

2026-01-25T11:39:48Z

```
I'll start by exploring the codebase to understand the structure and then locate the workflow file that needs to be fixed.
Let me first explore the repository structure to find the workflow file.
Now let me read the release workflow file to see the current implementation:
Perfect! I can see the issue clearly. The problem is on lines 67 and 78:

- Line 34: `asset_name: chant-windows-x86_64.exe` (already has .exe)
- Line 67: `cp target/${{ matrix.target }}/release/chant.exe ${{ matrix.asset_name }}.exe` (adds another .exe)
- Line 78: `gh release upload ${{ github.ref_name }} ${{ matrix.asset_name }}.exe` (another .exe)

Let me mark the first todo as completed and move to the fix:
Now I'll fix the issue by:
1. Removing the extra `.exe` on line 67
2. Removing the extra `.exe` on line 78
3. Since both branches now do the same thing, I'll simplify to remove the OS conditionals
Perfect! Let me verify the changes by reading the file again:
Excellent! The changes look good. Now let me update the spec file to mark the acceptance criteria as complete and add the model information:
Now let me update the spec file with the completed acceptance criteria and add the model information:
Now let me update my todos to reflect completion:
Now let me create a git commit with the changes:
Perfect! I've successfully completed the spec. Here's a summary of what was done:

## Summary

**Fixed Windows binary double `.exe` extension in release workflow**

### Changes Made

1. **Line 66** - Simplified the artifact preparation step:
   - Removed the OS conditional and replaced with a single command using `${{ matrix.bin_name }}`
   - Changed from: `cp target/${{ matrix.target }}/release/chant.exe ${{ matrix.asset_name }}.exe`
   - Changed to: `cp target/${{ matrix.target }}/release/${{ matrix.bin_name }} ${{ matrix.asset_name }}`

2. **Line 73** - Simplified the release upload step:
   - Removed the OS conditional since both branches did the same thing
   - Changed from: conditional check with `${{ matrix.asset_name }}.exe`
   - Changed to: `gh release upload ${{ github.ref_name }} ${{ matrix.asset_name }}`

### Result

- Windows artifacts will now be named correctly: `chant-windows-x86_64.exe` (single extension)
- Workflow is cleaner and more maintainable with redundant OS conditionals removed
- All acceptance criteria have been met and marked complete

The commit has been created with the message `chant(2026-01-25-00m-0ta): Fix Windows binary double .exe extension in release workflow`.```
