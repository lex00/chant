---
type: code
status: completed
depends_on:
- 2026-02-09-004-8yx
target_files:
- src/cmd/work/parallel.rs
- src/spec_group.rs
- src/spec/parse.rs
branch: chant/2026-02-10-001-3ss
---
# Parallel mode: group-aware concurrency for spec groups
## Problem
`chant work --parallel` has no concept of spec groups. It treats all ready specs as independent, which means it can start members from downstream groups before upstream groups finish. It also can't exploit intra-group parallelism (members within a group that share no dependency).

## Solution
Make parallel mode group-aware:
- Build a DAG of groups from driver `depends_on` fields
- Independent groups (no shared dependency relationship) can run concurrently
- Within a group, use member `depends_on` to determine which members can run in parallel (members that share no dependency can execute concurrently)
- A member starts as soon as all members it `depends_on` within the group are completed
- Never start a group's members until all upstream groups (driver `depends_on`) are fully completed
- Never execute driver specs directly — only members
- Standalone specs (not in any group) participate based on their own `depends_on`

Key files:
- `src/cmd/work/parallel.rs` — main parallel execution logic
- `src/spec_group.rs` — group membership and driver helpers
- `src/spec/parse.rs` — `is_ready` readiness checks

## Acceptance Criteria
- [ ] Independent groups run concurrently in parallel mode
- [ ] Dependent groups wait for upstream groups to complete before starting
- [ ] Members within a group run concurrently when their intra-group `depends_on` allow it
- [ ] Driver specs are never executed directly in parallel mode
- [ ] Standalone specs execute based on their own `depends_on` ordering
- [ ] Existing tests pass (`cargo test`)
- [ ] `cargo clippy -- -D warnings` passes