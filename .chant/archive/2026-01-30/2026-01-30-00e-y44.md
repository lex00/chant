---
type: group
status: completed
labels:
- cursor-integration
- enhancement
target_files:
- src/scoring.rs
- src/cmd/spec/lint.rs
- src/cmd/spec/add.rs
- src/cmd/lifecycle.rs
- src/cmd/work.rs
completed_at: 2026-01-31T18:09:14Z
model: auto-completed
---
# Spec Quality Scoring - Multi-dimensional analysis for complexity, confidence, and splittability

## Problem

Specs vary in quality and readiness. Issues include:
- Large specs that overwhelm agents
- Vague prose that leads to scope creep
- Poor structure that can't be split effectively
- Group members with excessive cross-references

Currently users must manually assess spec quality before work.

## Solution

Multi-dimensional scoring system with traffic light output:

```
ðŸŸ¢ Ready    - All dimensions pass
ðŸŸ¡ Review   - Some dimensions need attention
ðŸ”´ Refine   - Significant issues, refine before work
```

## Scoring Dimensions

### 1. Complexity (Size/Effort)

| Grade | Criteria Count | Target Files | Word Count |
|-------|----------------|--------------|------------|
| A | 1-3 | 1-2 | <200 |
| B | 4-5 | 3 | 200-400 |
| C | 6-7 | 4 | 400-600 |
| D | 8+ | 5+ | 600+ |

### 2. Confidence (Structure/Clarity)

Measures how well-structured the spec is:

| Signal | Good | Bad |
|--------|------|-----|
| Body structure | Bulleted lists | Walls of prose |
| Bullet quality | Starts with verb | Vague phrases |
| Specificity | Named files/functions | "improve", "as needed" |
| Scope creep risk | Bounded | "and related", "etc" |

Scoring:
- Count bullet points vs paragraph lines (ratio)
- Detect imperative verbs starting bullets
- Flag vague language patterns

### 3. Splittability (Decomposability)

Can this spec be effectively split?

| Grade | Signals |
|-------|---------|
| A | Clear subsections, independent tasks, multiple target files |
| B | Some structure, could be split with effort |
| C | Monolithic, single concern, splitting would fragment |
| D | Tightly coupled, splitting would create circular deps |

### 4. Isolation (Group/Split Quality)

For groups with members, measures member independence:

| Signal | Good | Bad |
|--------|------|-----|
| Cross-references | Only in `depends_on` | References in body text |
| Shared files | Minimal overlap | Same files in multiple members |
| Interface clarity | Clear Provides/Requires | Implicit dependencies |

Score: `(members without body cross-refs) / total members * 100`

### 5. Acceptance Criteria Quality

Each criterion scored on:
1. **Phrasing** - Starts with imperative verb
2. **Value** - Addresses implementation requirement
3. **Testability** - Can verify completion

AC Quality = average of individual criterion scores

## Traffic Light Logic

```
ðŸŸ¢ Ready:   Complexity â‰¤ B AND Confidence â‰¥ B AND AC Quality â‰¥ B
ðŸŸ¡ Review:  Any dimension is C
ðŸ”´ Refine:  Any dimension is D OR Confidence is D
```

## Integration Points

### `chant add`
After creation, show quality score:
```
Created 00d-vao
Quality: ðŸŸ¡ Review
  Complexity: B (5 criteria, 3 files)
  Confidence: C (low bullet ratio, vague language detected)
  Splittability: A

Suggestion: Add more specific acceptance criteria
```

### `chant lint`
Show quality for each spec:
```
00d-vao: ðŸŸ¡ Review | Complexity: B | Confidence: C | Splittable: A
00e-xyz: ðŸŸ¢ Ready  | Complexity: A | Confidence: A | Splittable: B
00f-abc: ðŸ”´ Refine | Complexity: D | Confidence: D | Splittable: C
         â†’ 12 criteria, walls of text, suggest refining before work
```

### `chant split`
Before splitting, check splittability. After splitting, score isolation:
```
Split quality: ðŸŸ¡ Review
  Member isolation: 67% (2/6 members have body cross-references)
  Shared files: src/config.rs appears in 3 members

Suggestion: Review members 3, 5 for tighter isolation
```

### `chant work`
Warn before starting low-quality specs:
```
Warning: Spec 00d-vao has quality ðŸ”´ Refine
  Confidence: D (vague requirements may cause agent confusion)

Continue anyway? [y/N]
```

## Acceptance Criteria

- [ ] Define `SpecScore` struct with dimensions: complexity, confidence, splittability, isolation, ac_quality
- [ ] Implement complexity scoring based on criteria/files/words
- [ ] Implement confidence scoring: bullet ratio, verb detection, vague language patterns
- [ ] Implement splittability scoring based on structure analysis
- [ ] Implement isolation scoring for groups (cross-reference detection)
- [ ] Implement AC quality scoring: phrasing, value, testability
- [ ] Add traffic light logic combining dimension grades
- [ ] Integrate scoring into `chant lint` output
- [ ] Integrate scoring into `chant add` with suggestions
- [ ] Integrate scoring into `chant split` (before and after)
- [ ] Integrate scoring into `chant work` with optional warning
- [ ] Add vague language pattern list (configurable in config.md)
- [ ] Unit tests for each scoring dimension