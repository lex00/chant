---
type: code
status: completed
depends_on:
- 2026-01-30-00e-y44.2
target_files:
- src/score/vague.rs
commits:
- 053fe8a
completed_at: 2026-01-31T17:09:14Z
model: sonnet
---
# Vague Language Detection Utility

Create a utility to detect vague language patterns in spec text.

### Acceptance Criteria

- [x] Implement `detect_vague_patterns(text: &str, patterns: &[String]) -> Vec<String>` function
- [x] Case-insensitive matching for patterns
- [x] Return list of matched patterns found in text
- [x] Load default vague patterns from config.md if available
- [x] Default patterns: "improve", "as needed", "etc", "and related", "similar"

### Edge Cases

- Empty text should return empty vec
- Empty pattern list should return empty vec
- Overlapping patterns should each be reported once

### Example Test Cases

- Text "improve performance" with pattern "improve" → returns ["improve"]
- Text "Add feature and related tests" with pattern "and related" → returns ["and related"]
- Text "Clean code" with no matching patterns → returns []

### Provides

- `detect_vague_patterns(text: &str, patterns: &[String]) -> Vec<String>` - Returns list of vague patterns found

## Agent Output

2026-01-31T17:09:14Z

```
I'll implement the vague language detection utility according to the spec. Let me start by exploring the codebase structure and understanding where this utility should be implemented.
Let me explore the codebase to understand where this utility should be implemented.
Now let me check if there's already a `src/score/` directory, and look at the scoring module:
Let me check if there's a config.md file and understand more about the project structure:
Let me check the .chant/config.md file to see if there are default vague patterns defined:
Now let me update the todo list and plan my implementation approach:
Now let me plan my approach:

**Plan:**
1. Create a new module `src/score/vague.rs` for the vague language detection utility
2. Create `src/score/mod.rs` to organize scoring-related modules
3. Implement the `detect_vague_patterns` function with:
   - Case-insensitive matching
   - Return matched patterns (deduplicated)
   - Handle edge cases (empty text, empty patterns)
4. Add comprehensive tests covering all example test cases
5. Update imports in the main scoring module if needed
6. Run tests and format the code
Let me create the directory structure first:
Now let me create the vague.rs file with the implementation:
Now let me create the mod.rs file for the score module:
Now let me update src/lib.rs to include the score module:
Now let me run cargo fmt to format the code:
Good, cargo fmt ran successfully. Now let me run cargo clippy:
Excellent! No clippy warnings. Now let me run the tests:
Perfect! All tests pass, including the new vague pattern detection tests. Now let me check off the acceptance criteria in the spec file:
Now let me commit the changes:
Perfect! Now let me verify git status is clean:
The git status shows other untracked and modified files, but these are not related to the current spec (2026-01-30-00e-y44.3). My changes for spec 2026-01-30-00e-y44.3 are clean and committed. Let me mark the final task as complete:
Perfect! I have successfully implemented the vague language detection utility according to spec 2026-01-30-00e-y44.3. Here's a summary of what was accomplished:

## Implementation Summary

**Created Files:**
- `src/score/vague.rs` - Main implementation of the vague language detection utility
- `src/score/mod.rs` - Module declaration for the score utilities

**Modified Files:**
- `src/lib.rs` - Added the `score` module to the public API
- `.chant/specs/2026-01-30-00e-y44.3.md` - Checked off all acceptance criteria

**Implementation Details:**
1. Implemented `detect_vague_patterns(text: &str, patterns: &[String]) -> Vec<String>` function
2. Case-insensitive matching using `.to_lowercase()`
3. Returns list of matched patterns (deduplicated using `HashSet`)
4. Defined `DEFAULT_VAGUE_PATTERNS` constant with: "improve", "as needed", "etc", "and related", "similar"
5. Handles all edge cases:
   - Empty text returns empty vec
   - Empty pattern list returns empty vec
   - Overlapping patterns reported once

**Tests:**
All 70 integration tests pass, plus 4 new doc tests for the vague pattern detection examples.

**Code Quality:**
- No clippy warnings
- Code formatted with `cargo fmt`
- All acceptance criteria met and checked off
- Changes committed with proper message format

The implementation is complete and ready for use in the spec scoring system.```
