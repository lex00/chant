---
type: code
status: completed
depends_on:
- 2026-02-03-02p-ydf.2
- 2026-02-03-02p-ydf.5
target_files:
- src/mcp/tools/watch.rs
- src/mcp/mod.rs
commits:
- 423b353
completed_at: 2026-02-03T23:42:29Z
model: sonnet
---
# Add MCP tools for watch visibility

Expose watch status via MCP for debugging and manual control.

### Inherited Context

- MCP is the interface for external tools (Claude, etc.)
- Watch runs autonomously, MCP provides visibility only
- Optional feature, does not block core functionality

### Acceptance Criteria

- [x] `chant_watch_status` tool returns active worktrees and their statuses
- [x] `chant_watch_start` tool manually starts watch
- [x] `chant_watch_stop` tool gracefully stops watch
- [x] Tools return structured JSON responses

### Edge Cases

- Watch not running: `chant_watch_status` should return empty list or clear message
- Stop watch while work in progress: Should warn but allow (work resumes on restart)

### Example Test Cases

- Run `chant_watch_status` with no worktrees, verify empty response
- Start work, run `chant_watch_status`, verify worktree listed with status
- Run `chant_watch_stop`, verify watch exits gracefully

## Agent Output

2026-02-03T23:42:29Z

```
I'll implement the MCP tools for watch visibility. Let me start by understanding the codebase structure.
## Summary

Added MCP tools for watch visibility in `src/mcp/tools/watch.rs` with three new tools registered in the MCP handlers:

- `chant_watch_status` - Returns watch process status, active worktrees, and their agent statuses
- `chant_watch_start` - Spawns watch process in background 
- `chant_watch_stop` - Sends graceful shutdown signal to watch process

All tools return structured JSON responses. Edge cases handled: watch not running returns empty worktree list, status files missing treated as "unknown" status.```
