---
type: code
status: completed
model: claude-opus-4-5
target_files:
  - src/cmd/spec.rs
---

# Lint: warn on spec complexity - too many acceptance criteria or target files or long descriptions

Add lint warnings in `chant lint` to detect specs that may be too complex for haiku execution.

## Rationale

Specs should be granular enough for haiku to execute successfully. Complex specs often indicate the work should be split into smaller pieces.

## Complexity Indicators

| Indicator | Threshold | Warning |
|-----------|-----------|---------|
| Acceptance criteria | > 5 | "Spec has N acceptance criteria - consider splitting" |
| Target files | > 5 | "Spec touches N files - consider splitting" |
| Description length | > 500 words | "Spec description is N words - may be too complex" |

## Implementation

Add to `validate_spec_type()` or create new `validate_spec_complexity()`:

```rust
fn validate_spec_complexity(spec: &Spec) -> Vec<String> {
    let mut warnings = Vec::new();

    // Count acceptance criteria (unchecked checkboxes)
    let criteria_count = count_checkboxes(&spec.body);
    if criteria_count > 5 {
        warnings.push(format!(
            "Spec has {} acceptance criteria - consider splitting for haiku",
            criteria_count
        ));
    }

    // Count target files
    if let Some(files) = &spec.frontmatter.target_files {
        if files.len() > 5 {
            warnings.push(format!(
                "Spec touches {} files - consider splitting",
                files.len()
            ));
        }
    }

    // Count words in body
    let word_count = spec.body.split_whitespace().count();
    if word_count > 500 {
        warnings.push(format!(
            "Spec description is {} words - may be too complex for haiku",
            word_count
        ));
    }

    warnings
}
```

## Acceptance Criteria

- [ ] Lint warns when spec has > 5 acceptance criteria
- [ ] Lint warns when spec has > 5 target files
- [ ] Lint warns when spec body exceeds 500 words
- [ ] Warnings suggest splitting or using stronger model
- [ ] Tests for each threshold
