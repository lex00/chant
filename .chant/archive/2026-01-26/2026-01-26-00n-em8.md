---
type: code
status: completed
model: claude-opus-4-5
target_files:
  - src/cmd/spec.rs
---

# Lint: warn on spec coupling - detect spec ID references in body text

Add lint warning when spec body text references other spec IDs, indicating coupling between specs.

## Rationale

Specs should be self-contained and executable independently. When a spec's body references another spec ID (e.g., "see 2026-01-26-00a-xyz for details"), it creates implicit coupling that:

1. Makes specs harder to understand in isolation
2. Creates hidden dependencies not captured in `depends_on`
3. Suggests the specs might need to be combined or restructured

Note: `depends_on` in frontmatter is the correct way to express dependencies. Body references are a smell.

## Detection

Use regex to find spec ID patterns in body text:

```rust
// Pattern: YYYY-MM-DD-XXX-abc (with optional .N suffix for members)
let spec_id_pattern = r"\b\d{4}-\d{2}-\d{2}-[0-9a-z]{3}-[0-9a-z]{3}(?:\.\d+)?\b";
```

Exclude:
- The spec's own ID
- IDs in code blocks (might be examples)
- IDs in `depends_on` discussion

## Warning Message

```
Spec references other spec ID(s) in body: 2026-01-26-00a-xyz
  - Use depends_on for explicit dependencies
  - Consider making spec self-contained
```

## Acceptance Criteria

- [ ] Lint detects spec ID patterns in body text
- [ ] Excludes the spec's own ID from warnings
- [ ] Excludes IDs inside code blocks
- [ ] Warning suggests using depends_on instead
- [ ] Tests for detection and exclusions
