---
type: code
status: completed
target_files:
- src/cmd/lifecycle.rs
commits:
- add948f
model: haiku
---
# Archive command should use git mv to preserve history

## Problem

The `chant archive` command uses `std::fs::rename` to move specs to the archive directory. This confuses agents because:
- Git sees a delete + add instead of a move
- History is harder to track
- Agents may think files disappeared unexpectedly

## Solution

Change `cmd_archive` to use `git mv` instead of filesystem rename:
- Use `git mv .chant/specs/XXX.md .chant/archive/XXX.md`
- Fall back to fs::rename only if not in a git repo

## Acceptance Criteria

- [x] Archive uses `git mv` when in a git repository
- [x] Falls back to `fs::rename` if git mv fails or not in git repo
- [x] `just lint` passes
- [x] `just test` passes