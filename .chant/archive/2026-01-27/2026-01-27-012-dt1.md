---
type: code
status: completed
target_files:
- src/main.rs
- CLAUDE.md
commits:
- 27a2d84
completed_at: 2026-01-27T23:59:23Z
model: opus
---
# Fix 012-w8v: Register refresh command in CLI Commands enum

## Problem

Spec 012-w8v (Add chant refresh command) was marked completed but the command is not accessible:

- Implementation exists: `src/cmd/refresh.rs` (227 lines)
- Module declared: `pub mod refresh;` in `src/cmd/mod.rs`
- Code compiles successfully
- **BUT** command not registered in CLI Commands enum in `src/main.rs`
- **Result**: Users cannot run the command

**Evidence from audit**:
```bash
$ chant refresh
error: unrecognized subcommand 'refresh'

$ chant --help
# No 'refresh' command listed
```

**What exists**:
- ✓ `src/cmd/refresh.rs` with `cmd_refresh()` function
- ✓ Module declaration in `src/cmd/mod.rs`
- ✓ Documentation in `docs/reference/cli.md`
- ✗ CLI command registration in `src/main.rs`
- ✗ Documentation in CLAUDE.md

## Solution

1. Add `Refresh` command to the Commands enum in `src/main.rs`:

```rust
#[derive(Subcommand)]
enum Commands {
    // ... existing commands

    /// Refresh dependency status for all specs
    Refresh {
        /// Show detailed list of ready and blocked specs
        #[arg(short, long)]
        verbose: bool,
    },

    // ... more commands
}
```

2. Add match arm to handle the command:

```rust
Commands::Refresh { verbose } => cmd::refresh::cmd_refresh(verbose),
```

3. Add to CLAUDE.md documentation under "Core Commands" section.

## Acceptance Criteria

- [x] Add Refresh variant to Commands enum
- [x] Add verbose field to Refresh command
- [x] Add doc comment for the command
- [x] Add match arm calling `cmd::refresh::cmd_refresh(verbose)`
- [x] Verify `chant --help` shows refresh command
- [x] Test: `chant refresh` runs successfully
- [x] Test: `chant refresh --verbose` shows detailed output
- [x] Update CLAUDE.md with refresh command
- [x] All existing tests pass