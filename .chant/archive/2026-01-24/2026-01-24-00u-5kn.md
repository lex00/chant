---
type: code
status: completed
target_files:
- src/main.rs
- docs/reference/cli.md
commits:
  - d25c32d
completed_at: 2026-01-24T12:48:41Z
---
# Implement --parallel flag for concurrent spec execution

Add a `--parallel` flag to `chant work` that executes all ready specs concurrently.

## Acceptance Criteria

- [x] Add `--parallel` flag to work command
- [x] When used without spec ID, execute all ready specs in parallel
- [x] Spawn multiple agent processes concurrently
- [x] Stream output from all agents (prefixed with spec ID)
- [x] Wait for all agents to complete
- [x] Report summary of results (passed/failed counts)
- [x] Update docs/reference/cli.md with examples

## Example Usage

```bash
# Execute all ready specs in parallel
chant work --parallel

# Execute specific spec (normal behavior, --parallel ignored)
chant work 001

# Combine with label filter
chant work --parallel --label auth
```

## Example Output

```
→ Starting 3 specs in parallel...

[00m-khh] Working with prompt 'standard'
[00n-1nl] Working with prompt 'standard'
[00o-6w7] Working with prompt 'standard'

[00m-khh] ✓ Completed (commit: abc1234)
[00n-1nl] ✓ Completed (commit: def5678)
[00o-6w7] ✓ Completed (commit: ghi9012)

Summary: 3 completed, 0 failed
```

## Implementation Notes

- Use `std::thread::spawn` or `tokio` for concurrency
- Each agent runs in its own process via `invoke_agent`
- Collect output streams and prefix with spec ID
- Handle failures gracefully (one failure shouldn't stop others)
- Consider adding `--max-parallel N` to limit concurrency

## Agent Output

2026-01-24T12:48:41Z

```
The spec has been implemented successfully. Here's a summary of what was done:

## Summary

Implemented the `--parallel` flag for concurrent spec execution in chant.

### Changes Made:

1. **`src/main.rs`**:
   - Made the `id` argument optional in the `Work` command
   - Added `--parallel` flag to execute all ready specs concurrently
   - Added `--label` filter support for parallel execution
   - Implemented `cmd_work_parallel()` function using `std::thread::spawn` for concurrency
   - Added `invoke_agent_with_prefix()` to stream output with spec ID prefix
   - Added `ParallelResult` struct to track execution results
   - Reports summary of completed/failed counts at the end

2. **`docs/reference/cli.md`**:
   - Added "Parallel Execution" subsection with usage examples
   - Documented `--parallel` and `--label` flags
   - Included example output showing the parallel execution format

### Key Features:
- `chant work --parallel` - Executes all ready specs concurrently
- `chant work --parallel --label auth` - Filter by labels
- Output is prefixed with `[spec-id]` for each agent
- Graceful failure handling (one failure doesn't stop others)
- Summary shows completed/failed counts

### Commit:
`chant(2026-01-24-00u-5kn): Implement --parallel flag for concurrent spec execution````
