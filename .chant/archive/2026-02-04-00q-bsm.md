---
type: code
status: completed
target_files:
- tests/support/builders.rs
- tests/support/mod.rs
branch: chant/2026-02-04-00q-bsm
commits:
- c0df1b9
completed_at: 2026-02-04T22:14:57Z
model: sonnet
---
# Add SpecBuilder for test convenience

## Problem

Tests create Spec objects with verbose struct initialization. Need builder pattern.

## Solution

Create `tests/support/builders.rs` with `SpecBuilder` for fluent test object construction.

## Acceptance Criteria

- [x] Create `tests/support/mod.rs` that exports `builders` module
- [x] Create `tests/support/builders.rs` with `SpecBuilder` struct
- [x] Add `SpecBuilder::new(id: &str) -> Self` constructor
- [x] Add `.with_status(status: SpecStatus) -> Self` method
- [x] Add `.with_depends_on(deps: Vec<String>) -> Self` method
- [x] Add `.build() -> Spec` method returning constructed Spec
- [x] Run `cargo build --tests` and confirm zero errors

## Agent Output

2026-02-04T22:14:57Z

```
I'll implement the SpecBuilder for test convenience. Let me start by reading the relevant code to understand the Spec structure.
Now I'll create the SpecBuilder. I can see that Spec has:
- `id: String`
- `frontmatter: SpecFrontmatter`
- `title: Option<String>`
- `body: String`

And SpecStatus is an enum with variants like `Pending`, `InProgress`, etc.
I need to update the builder to include the two new fields: `public` and `retry_state`.
## Summary

Created SpecBuilder in `tests/support/builders.rs` for fluent test object construction.

- Added `tests/support/mod.rs` to export builders module
- Implemented `SpecBuilder` with constructor, fluent methods, and build function
- All acceptance criteria met, tests compile successfully
- Unrelated file `src/cmd/lifecycle/split.rs` has uncommitted changes (not part of this spec)```
