---
type: code
status: completed
commits:
- 55e9006
completed_at: 2026-02-05T12:13:59Z
model: sonnet
---
# Add chant init --provider kirocli to auto-configure kiro-cli-chat MCP server - runs kiro-cli-chat mcp add with correct command path and args format automatically

## Output



Additional requirements:
- Integrate with existing `chant init` wizard flow
- Use `kiro-cli-chat mcp add --name chant --command <path> --args mcp --scope global --force` to overwrite existing config gracefully
- Detect if kiro-cli-chat is installed before offering the option
- Show success/failure feedback after setup

## Agent Output

2026-02-05T12:13:59Z

```
I'll implement the `chant init --provider kirocli` feature to auto-configure the kiro-cli-chat MCP server.
Now I need to add the kiro-cli-chat MCP configuration step after the agent configuration section. Let me check where the function ends and understand the structure better.
Now I need to understand the code structure better - specifically the wizard flow. Let me look at where the kirocli provider option should be added.
Now I understand the structure. I need to:
1. Add "kirocli" to the parse_provider_string function
2. Add a wizard flow step to offer kiro-cli-chat MCP setup after agent configuration
3. Create a helper function to configure kiro-cli-chat MCP

Let me implement the changes:
Now I need to add a helper function to configure kiro-cli-chat MCP. Let me find a good place for it:
Now I'll add a helper function to configure kiro-cli-chat MCP, placing it after update_claude_mcp_config:
Now I need to add the wizard flow option. Let me find where the agent selection happens and add a follow-up prompt:
Now I need to add the kiro-cli-chat MCP setup prompt. This should happen after the agent configuration in the wizard flow. Let me add it:
Now I need to update the non-wizard direct mode path to also return this flag, and update the destructuring:
Now I need to update the destructuring statement and use the setup_kirocli flag:
Now I need to add the call to configure_kirocli_mcp at the end of the initialization. Let me find where that should go:
Now I'll add the kiro-cli-chat MCP setup call before the final "Done!" message:
Now I also need to handle the case where someone runs `chant init --provider kirocli` on an existing project. Let me check the surgical update section:
I need to update the surgical provider update to handle kirocli specially:
Now let me also update the configuration menu in the existing project section:
I should add kirocli as an option in the configuration menu:
Now let me also add it to the wizard flow's provider options for new projects:
Good, the wizard flow already has the kirocli setup prompt. Now let's run cargo fmt and clippy:
Great! Now let me test the implementation. First, let me verify the changes work:
I see the issue - the error message is still showing the old message. Let me check:
I see - the binary wasn't rebuilt. Let me rebuild:
Excellent! It works. Let me verify the MCP was actually added:
Perfect! Now let me test updating an existing project:
Perfect! Now let me check the spec and mark criteria as complete:
The spec doesn't have acceptance criteria checkboxes. Let me verify the implementation meets all requirements and commit:
Perfect! Let me also test the wizard flow to ensure it works properly:
Excellent! Everything works correctly. Let me update the spec status to completed:
## Summary

Added `chant init --provider kirocli` to auto-configure kiro-cli-chat MCP server.

- Modified `src/main.rs` to recognize "kirocli" as a provider option
- Created `configure_kirocli_mcp()` that runs `kiro-cli-chat mcp add` with correct arguments
- Integrated into wizard flow with auto-detection of kiro-cli-chat installation
- Added to configuration menu for existing projects
- Handles both new initialization and surgical updates via `--provider kirocli`
- Shows success/failure feedback with restart reminder

Tested successfully with both new projects and existing project updates.```
