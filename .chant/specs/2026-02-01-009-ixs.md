---
type: code
status: pending
target_files:
- .chant/prompts/release.md
---

# Design release prompt

Create a prompt that guides agents through the complete release workflow using chant commands.

## Workflow Steps

The release prompt should orchestrate these steps in order:

### 1. Pre-release Validation
- Run `chant status` to check project state
- Ensure no specs are in_progress or failed
- List any pending specs that should be addressed first

### 2. Finalize Completed Work
- Run `chant finalize` on any completed specs missing finalization
- Validate all acceptance criteria are checked

### 3. Merge Feature Branches
- Run `chant merge --all` to merge completed spec branches
- Handle merge conflicts if any arise
- Ensure main branch is clean after merges

### 4. Cleanup
- Run `chant archive` on completed specs
- Run `chant cleanup` to remove stale worktrees
- Commit archive changes

### 5. Git Status Cleanup
- Ensure on main branch
- Commit any uncommitted changes (spec archives, etc.)
- Push to origin

### 6. Cut Release
- Bump version in Cargo.toml (prompt for major/minor/patch)
- Update Cargo.lock
- Update CHANGELOG.md with release notes
- Commit version bump
- Create and push git tag
- Create GitHub release

### 7. Update Release Notes
- Generate release notes from:
  - Commits since last release
  - Completed specs in this release
  - CHANGELOG.md content
- Update GitHub release with detailed notes

### 8. Monitor CI
- Watch CI workflows until completion
- Report success/failure status
- Retry release workflow if it fails

## Acceptance Criteria

- [ ] Create `.chant/prompts/release.md` with complete workflow
- [ ] Prompt uses chant commands (status, finalize, merge, archive, cleanup)
- [ ] Prompt uses git commands for version bump and tagging
- [ ] Prompt uses gh CLI for release creation and notes
- [ ] Prompt includes error handling and recovery steps
- [ ] Prompt can be invoked via `chant work <spec> --prompt release`

## Template Variables

The prompt should accept these variables:
- `{{version_bump}}` - major, minor, or patch
- `{{skip_ci_wait}}` - skip waiting for CI completion

## Example Usage

```bash
# Standard release
chant work <spec> --prompt release

# Quick release without CI wait
chant work <spec> --prompt release  # with skip_ci_wait context
```
