---
type: code
status: pending
target_files:
  - src/spec.rs
  - src/cmd/work.rs
---

# Add research spec type with informed_by and origin fields

Implement the `type: research` spec type for analysis, synthesis, and investigation workflows.

## Context

Research specs study input materials and produce findings:

```yaml
---
type: research
informed_by:
  - papers/methodology.pdf
  - src/**/*.rs
origin:
  - data/metrics.csv
target_files:
  - analysis/findings.md
---
```

- `informed_by`: Materials to read/synthesize (triggers drift when changed)
- `origin`: Input data to analyze (triggers drift when changed)

See: docs/concepts/spec-types.md for the full specification.

## Implementation

### Frontmatter Fields

Add fields to frontmatter parsing:

```rust
pub struct Frontmatter {
    // ... existing fields
    pub informed_by: Option<Vec<String>>,  // Materials to synthesize
    pub origin: Option<Vec<String>>,        // Input data
}
```

- Both are `Vec<String>` (file paths or glob patterns)
- Both are optional (can have one, both, or neither)
- Only valid for `type: research`
- Patterns are relative to repo root

### Type Validation

When `type: research`:
- At least one of `informed_by` or `origin` should be present (warn if both missing)
- `target_files` should be present

### Prompt Selection

Auto-select prompt when `type: research`:
- If `origin` is set (data analysis): prefer `research-analysis`
- If only `informed_by` (synthesis): prefer `research-synthesis`
- Fall back to `research-synthesis` if neither prompt exists

### Drift Detection (Future)

Store input file state at completion for future drift detection. For now, just parse and validate the fields.

## Acceptance Criteria

- [ ] `informed_by` field parses correctly in frontmatter
- [ ] `origin` field parses correctly in frontmatter
- [ ] `type: research` is a valid spec type
- [ ] Lint warns if research spec missing both `informed_by` and `origin`
- [ ] Lint warns if research spec missing `target_files`
- [ ] Auto-selects appropriate research prompt if available
- [ ] All existing tests pass
- [ ] New tests for research type validation
