---
type: code
status: in_progress
target_files:
- src/cmd/cleanup.rs
- src/worktree.rs
---
# Fix cleanup not finding worktrees that worktree status marks as prunable

## Problem

`chant worktree status` and `chant cleanup` use different logic to identify orphan worktrees:

```
% chant worktree status
Found 1 chant worktree:

  /private/tmp/chant-2026-01-27-00n-0td [prunable]
    Branch: chant/2026-01-27-00n-0td
    Spec:   2026-01-27-00n-0td
    Status: unknown (spec not found)
    Reason: gitdir file points to non-existent location

âš  1 prunable worktree (run chant cleanup to clean up)

% chant cleanup
No orphan worktrees found.
```

The `worktree status` command correctly identifies the worktree as prunable, but `cleanup` doesn't find it.

## Root Cause

Likely the commands use different discovery methods:
- `worktree status` may use `git worktree list` or scan `/tmp/chant-*`
- `cleanup` may only look for worktrees with active specs or different path patterns

## Solution

Unify the worktree discovery logic so both commands find the same worktrees.

## Acceptance Criteria

- [x] `chant cleanup` finds and removes worktrees that `worktree status` marks as prunable
- [x] Both commands use shared worktree discovery logic
- [x] Worktrees with "gitdir file points to non-existent location" are cleaned up