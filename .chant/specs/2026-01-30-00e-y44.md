---
type: code
status: pending
target_files:
  - src/commands/lint.rs
  - src/commands/add.rs
  - src/spec.rs
labels:
  - cursor-integration
  - enhancement
---

# Complexity Scoring - Auto-estimate spec complexity and suggest splits

## Problem

Large, complex specs often lead to struggling agents. Currently there's no way to detect this before starting work. Users must manually assess whether a spec should be split.

## Solution

Add automatic complexity scoring that:
1. Analyzes spec characteristics (criteria count, target files, word count)
2. Assigns a complexity score (S/M/L/XL)
3. Warns when complexity is high
4. Suggests splitting for XL specs

## Complexity Heuristics

| Factor | Weight | Notes |
|--------|--------|-------|
| Acceptance criteria count | High | >6 criteria = likely too big |
| Target files count | Medium | >4 files = consider splitting |
| Word count in description | Low | >500 words = complex scope |
| Dependencies count | Low | >3 deps = coordination overhead |

Scoring:
- **S (Small)**: 1-2 criteria, 1-2 files
- **M (Medium)**: 3-4 criteria, 2-3 files
- **L (Large)**: 5-6 criteria, 3-4 files
- **XL (Extra Large)**: >6 criteria OR >4 files

## Integration Points

### `chant lint`
Shows complexity for each spec:
```
00d-vao: [L] Spec Templates (6 criteria, 4 files)
         Consider splitting into smaller specs
```

### `chant add`
After creating a spec, warns if complexity will be high:
```
Created 00d-vao
Warning: Estimated complexity is Large (6 criteria, 4 files)
Consider splitting this spec for better agent success rate.
```

### Frontmatter Storage
Optionally store computed complexity:
```yaml
complexity: large
complexity_score: 8
```

## Acceptance Criteria

- [ ] Complexity enum defined: Small, Medium, Large, ExtraLarge
- [ ] Complexity calculation function analyzing criteria count, file count, word count
- [ ] `chant lint` displays complexity score for each spec
- [ ] Warning message when complexity >= Large with suggestion to split
- [ ] `chant add` shows complexity warning after creating spec (if >= Large)
- [ ] Complexity thresholds configurable in config.md
- [ ] Unit tests for complexity calculation with various inputs
- [ ] `--complexity` flag for `chant list` to filter by complexity level
