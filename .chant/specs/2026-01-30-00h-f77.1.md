---
type: code
status: pending
depends_on: []
target_files:
- src/config.rs
---
# Configuration schema for watch command

Add configuration types and parsing for `chant watch` behavior, including poll interval, retry logic, and failure handling.

### Inherited Context

- Monitor-only role: config should not enable agent spawning or new spec creation
- Supports finalize, merge, resume operations only

### Acceptance Criteria

- [ ] `WatchConfig` struct with `poll_interval_ms`, `failure` nested config
- [ ] `FailureConfig` struct with `max_retries`, `retry_delay_ms`, `backoff_multiplier`, `retryable_patterns`, `on_permanent_failure`
- [ ] Parse from `config.md` with defaults (5000ms poll, 3 retries, 60s delay, 2.0 backoff)
- [ ] `on_permanent_failure` enum: `skip` or `stop`
- [ ] Config validation: reject negative intervals, invalid multipliers

### Edge Cases

- Missing `watch` section in config.md: Use defaults
- Invalid `on_permanent_failure` value: Error with helpful message
- Empty `retryable_patterns`: No retries (permanent failure on any error)

### Example Test Cases

- Parse config with all fields set → matches expected struct
- Parse config with missing fields → fills in defaults
- Parse config with invalid enum → returns parse error


- `WatchConfig` struct with all fields
- `parse_watch_config() -> Result<WatchConfig>` - Errors on invalid schema

---