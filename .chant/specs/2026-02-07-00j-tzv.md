---
type: code
status: completed
depends_on:
- 2026-02-07-00i-vsk
labels:
- refactor
- work-engine
- dedup
target_files:
- src/cmd/work/chain.rs
- src/cmd/work/executor.rs
---
# Refactor chain.rs to use executor.rs shared functions

## Context

`src/cmd/work/executor.rs` has shared functions. After spec 00i, `single.rs` will be using them. This spec does the same for `chain.rs`.

## Task

Refactor `chain.rs` (currently ~800 LOC) to delegate to `executor.rs` shared functions. `chain.rs` should only contain:
- Sequential spec iteration (pick next ready spec)
- Chain-mode reporting (which spec is next, chain progress)
- Loop control (stop on failure, continue to next)

All validation, agent invocation, commit collection, finalization, and error handling should route through the same executor functions that single.rs uses.

## Acceptance Criteria

- [x] `chain.rs` is under 200 LOC
- [x] `chain.rs` calls the same executor functions as `single.rs`
- [x] AC handling follows the same policy as single mode
- [x] Finalization failure sets the same status as single mode
- [x] All existing tests pass
- [x] `cargo clippy` passes

## Output

chain.rs reduced from 806 to 395 LOC (51% reduction). All executor functions integrated. Consolidated two chain execution paths into one. All tests pass.
