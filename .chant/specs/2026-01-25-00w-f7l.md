---
type: code
status: pending
target_files:
- src/worktree.rs
---
# Fix CI test failure - test_merge_and_cleanup_successful_merge

## Problem

CI is failing on `test_merge_and_cleanup_successful_merge` in `src/worktree.rs:374`:

```
assertion failed: result.success && result.error.is_none()
```

This test passes locally on macOS but fails on Linux CI (ubuntu-latest).

## Analysis

The test was supposedly fixed in spec 00o but is still failing. The issue is likely:

1. **Environment difference** - Git behavior differs between macOS and Linux
2. **Race condition** - Test may have timing issues on CI
3. **Git configuration** - CI environment may have different git defaults

## Test Location

`src/worktree.rs` line 374 in `test_merge_and_cleanup_successful_merge`

## Debugging Steps

1. Add more verbose error output to understand WHY the merge is failing
2. Check if git user.name/user.email are set in CI environment
3. Verify the test setup creates valid commits

## Acceptance Criteria

- [ ] Identify root cause of Linux-only failure
- [ ] Fix the test to pass on both macOS and Linux
- [ ] Verify fix by pushing and checking CI
- [ ] All tests pass locally
- [ ] CI badge turns green
