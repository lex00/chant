---
type: code
status: in_progress
depends_on:
- 2026-01-30-00e-y44.1
target_files:
- src/score/complexity.rs
---
# Complexity Scoring Implementation

Implement scoring based on criteria count, target files, and word count.

### Inherited Context

- Complexity thresholds: ≤5 criteria, ≤5 files, ≤200 words is ideal (Grade A)
- Haiku-friendly specs should be Grade A or B

### Acceptance Criteria

- [x] Implement `calculate_complexity(spec: &Spec) -> ComplexityGrade` function
- [x] Grade A: 1-3 criteria, 1-2 files, <200 words
- [x] Grade B: 4-5 criteria, 3 files, 200-400 words
- [x] Grade C: 6-7 criteria, 4 files, 400-600 words
- [x] Grade D: 8+ criteria OR 5+ files OR 600+ words
- [x] Extract criteria count, file count, word count from Spec struct

### Edge Cases

- Specs with no target_files should default to 0 files
- Empty body should have word count of 0
- If any single metric triggers D, overall grade is D

### Example Test Cases

- Spec with 2 criteria, 1 file, 150 words → Grade A
- Spec with 5 criteria, 3 files, 300 words → Grade B
- Spec with 10 criteria, 2 files, 100 words → Grade D (criteria exceeds threshold)

### Provides

- `calculate_complexity(spec: &Spec) -> ComplexityGrade` - Returns grade based on criteria/files/words, errors if spec metadata missing