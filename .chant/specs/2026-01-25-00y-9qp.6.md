---
type: code
status: pending
depends_on:
- 2026-01-25-00y-9qp.5
target_files:
- src/spec_group.rs
- src/lib.rs
- src/spec.rs
---
# Extract spec group logic to src/spec_group.rs

Move driver/group orchestration logic into a dedicated library module. This is library code (not CLI-specific) that manages spec membership and completion tracking.

### Acceptance Criteria

- [ ] Create new library module `src/spec_group.rs` (in library, not binary)
- [ ] All group/driver functions moved from `src/spec.rs`:
  - `is_member_of()`
  - `get_members()`
  - `extract_driver_id()`
  - `extract_member_number()`
  - `all_members_completed()`
  - `get_incomplete_members()`
  - `all_prior_siblings_completed()`
  - `mark_driver_in_progress()`
  - `auto_complete_driver_if_ready()`
- [ ] Add `pub mod spec_group;` to `src/lib.rs` with appropriate exports
- [ ] `src/spec.rs` imports these functions from `spec_group` where used
- [ ] All public functions in spec_group are properly documented
- [ ] `spec.rs` is now under 1200 lines
- [ ] `just check` passes
- [ ] Spec driver/member logic works identically before/after

### Edge Cases

- **Member numbering**: Verify extraction correctly handles member ID suffixes (.1, .2, etc.)
- **Circular member checks**: Ensure a spec cannot be a member of itself
- **Sibling completion tracking**: Confirm all_prior_siblings_completed() correctly checks spec ordering
- **Driver status updates**: Verify mark_driver_in_progress() updates correct frontmatter fields
- **Auto-completion logic**: Check that auto_complete_driver_if_ready() only completes when ALL members are done

### Example Test Cases

For group logic, verify:
- `is_member_of("2026-01-25-00y-abc.1", "2026-01-25-00y-abc")` returns true
- `is_member_of("2026-01-25-00x-xyz", "2026-01-25-00y-abc")` returns false
- `extract_driver_id("2026-01-25-00y-abc.2")` returns "2026-01-25-00y-abc"
- `extract_member_number("2026-01-25-00y-abc.3")` returns Some(3)
- `all_members_completed()` returns false if any member is not completed
- `all_prior_siblings_completed("spec.3")` checks only specs 1 and 2, not 4+