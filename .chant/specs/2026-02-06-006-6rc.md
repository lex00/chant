---
type: code
status: completed
commits:
- 53ef8a2
completed_at: 2026-02-06T11:10:48Z
model: sonnet
---
# Research silent mode gaps - kiro provider configs and .gitattributes

Silent mode (`chant init --silent`) makes `.chant/` local-only (not tracked in git), but there are gaps:

1. **Kiro provider configs**: `.kiro/rules.md` and other provider config files (e.g., `.cursorrules`, `CLAUDE.md`) are written outside `.chant/` and would still be tracked in git even in silent mode. Should these be gitignored or skipped in silent mode?

2. **.gitattributes**: The merge driver setup writes to `.gitattributes`, which is also visible in git. In silent mode this leaks chant's presence into the repo.

Need to audit what artifacts `chant init` creates outside `.chant/` and decide how silent mode should handle each one.

---

## Research Findings

### Artifacts Created by `chant init`

Based on code analysis of `src/main.rs:cmd_init()` and `src/merge_driver.rs:setup_merge_driver()`:

**1. Provider Config Files (Agent Configurations)**
- `CLAUDE.md` (Claude Code)
- `.cursorrules` (Cursor)
- `.kiro/rules.md` (Kiro)
- `.ai-instructions` (Generic)
- Created in project root via `write_agent_config_file()` (main.rs:2436-2457)
- **Currently tracked in git in silent mode** ✗

**2. MCP Configuration Files**
- `.mcp.json` (legacy project-local config)
- `.claude/settings.json` (project-local config)
- `.claude/` is properly excluded via `.git/info/exclude` ✓
- `.mcp.json` is **tracked in git in silent mode** ✗

**3. .gitattributes**
- Created/updated by `setup_merge_driver()` (merge_driver.rs:400-478)
- Adds pattern: `.chant/specs/*.md merge=chant-spec`
- **Always visible in git, reveals chant presence** ✗

### Summary of Gaps

| Artifact | Location | Tracked in Silent Mode? | Issue? |
|----------|----------|-------------------------|--------|
| `.chant/` | Root | No (excluded) | ✓ OK |
| Provider configs | Root/`.kiro/` | Yes | ✗ Gap |
| `.mcp.json` | Root | Yes | ✗ Gap |
| `.claude/` | Root | No (excluded) | ✓ OK |
| `.gitattributes` | Root | Yes | ✗ Gap |

### Options for Fixing

**Option 1: Skip External Files in Silent Mode** (Strictest)
- Don't create provider configs, .mcp.json, or .gitattributes
- Pros: True stealth mode
- Cons: No agent configs, merge driver not configured

**Option 2: Add to .gitignore**
- Add provider configs to `.gitignore`
- Cons: `.gitignore` itself reveals chant usage

**Option 3: Use .git/info/exclude** (Recommended)
- Add provider configs and `.mcp.json` to `.git/info/exclude`
- Skip `.gitattributes` creation in silent mode
- Pros: Files exist locally but not tracked, `.git/info/exclude` is local-only
- Cons: Merge driver not available (minor - only affects branch workflows)

**Option 4: Document as Intended**
- Agent configs are meant to be shared
- Silent mode only hides `.chant/` (work-in-progress specs)
- Pros: No code changes
- Cons: May not meet user expectations

### Recommendation

Implement **Option 3**:
1. In silent mode, add provider configs and `.mcp.json` to `.git/info/exclude`
2. Skip `.gitattributes` creation (merge driver) in silent mode
3. Update `src/cmd/silent.rs` to exclude these files when enabling silent mode

This provides true stealth while keeping files available for local use.

## Agent Output

2026-02-06T11:10:48Z

```
I'll research the silent mode gaps by examining the init code and related files.
Now I have enough context. Let me document the findings:
## Summary

Researched silent mode gaps in chant initialization. Found 3 categories of artifacts created outside `.chant/`:

**Gap 1: Provider configs** (CLAUDE.md, .cursorrules, .kiro/rules.md, .ai-instructions) - tracked in git
**Gap 2: .mcp.json** - tracked in git  
**Gap 3: .gitattributes** - tracked in git (reveals merge driver)

Documented 4 options with recommendation: Use `.git/info/exclude` for external files and skip `.gitattributes` in silent mode. Research findings committed to spec.```
