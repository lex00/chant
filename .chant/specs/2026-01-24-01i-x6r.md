---
type: code
status: pending
depends_on:
  - 2026-01-24-01c-w2u
target_files:
- src/main.rs
---
# Fix split command output - titles, target_files parsing, acceptance criteria

The split command creates subtasks with several issues. Use spec `01e-o0l` as the test case.

## Problems Found

1. **Missing titles**: Subtasks have no `# Title` header - body starts with description directly, causing "(no title)" in `chant list`

2. **Invalid target_files**: Agent output like `src/main.rs (test module)` gets used verbatim. The `(test module)` annotation should be stripped.

3. **No acceptance criteria**: Subtasks lack `## Acceptance Criteria` sections, making completion validation harder.

## Expected Subtask Format

```markdown
---
type: code
status: pending
depends_on:
  - 2026-01-24-01e-o0l.1
target_files:
- src/main.rs
---
# Extract spec finalization into reusable function

Create a dedicated function that encapsulates all finalization steps...

## Acceptance Criteria

- [ ] Implement as described
- [ ] All tests pass
```

## Fix Loop

Use `01e-o0l` as test case. Iterate until split output is correct:

1. **Clean up** - Delete existing subtasks: `rm .chant/specs/2026-01-24-01e-o0l.*.md`
2. **Reset driver** - Change `01e-o0l` back to `type: code` (from `type: group`)
3. **Fix bugs** - Implement fixes in `cmd_split()` / `parse_subtasks()`
4. **Re-split** - Run `chant split 01e-o0l`
5. **Inspect** - Check subtask output for remaining issues
6. **Repeat** - Go to step 3 if issues found

## Acceptance Criteria

- [ ] Parse subtask title from agent output (e.g., "## Subtask 1: Title Here")
- [ ] Write `# Title` as first line of subtask body
- [ ] Strip annotations from target_files (remove parenthetical comments)
- [ ] Add default acceptance criteria to each subtask
- [ ] Test with `01e-o0l` - clean split with proper titles and criteria
- [ ] All tests pass
