---
type: research
status: pending
target_files:
- src/main.rs
---
# Handle merge conflicts after parallel execution - spawn conflict resolution specs

## Problem

After parallel execution with worktrees, multiple spec branches need to merge to main. When conflicts occur:
- Manual resolution is tedious
- Context about what each spec changed is lost
- No tracking of which conflicts are pending

## Proposed Solution

When merge conflict detected:
1. Create a new **conflict resolution spec** with:
   - Description of the conflict (files, branches involved)
   - Context from both conflicting specs
   - List of all unmerged branches in the chain
2. The conflict spec can be:
   - Worked by an agent (attempt auto-resolution)
   - Split into subtasks if multiple conflicts
   - Manually resolved by user

## Workflow

```
# After parallel execution completes:
chant merge --all

# If conflicts:
⚠ Conflict detected merging spec/01a into main
  Files: src/main.rs (lines 100-150)
  Creating conflict resolution spec...

Created: 2026-01-24-conflict-01a-main
  Conflicting specs: 01a, 01b (both modify src/main.rs)
  Unmerged chain: 01a, 01b, 01c

Run: chant work 2026-01-24-conflict-01a-main
```

## Conflict Spec Content

```markdown
# Resolve merge conflict: spec/01a → main

## Conflict Summary
- **Source branch**: spec/01a
- **Target branch**: main
- **Conflicting files**: src/main.rs

## Context from 01a
<summary of what 01a was trying to do>

## Context from conflicting spec (01b)
<summary of what 01b changed in same area>

## Unmerged Chain
These specs are blocked until this conflict resolves:
- 01b (also modifies src/main.rs)
- 01c (depends on 01b)

## Resolution Instructions
1. Review both changes
2. Edit conflicting files to resolve
3. Stage resolved files
4. Complete merge

## Acceptance Criteria
- [ ] Conflict in src/main.rs resolved
- [ ] Merge completed successfully
- [ ] Unmerged chain can now proceed
```

## Questions to Resolve

- [ ] Should agent attempt auto-resolution first?
- [ ] How to extract "context" from each spec for the conflict description?
- [ ] Should conflict specs be a special `type: conflict`?
- [ ] How to track the "unmerged chain" - specs waiting on this resolution?
- [ ] Should conflict resolution trigger re-attempt of blocked merges?

## Acceptance Criteria

- [ ] Detect merge conflicts during `chant merge`
- [ ] Create conflict resolution spec with context
- [ ] Include list of blocked/unmerged specs
- [ ] Conflict spec can be worked by agent
- [ ] After resolution, blocked merges can proceed
- [ ] Track conflict specs separately (maybe `type: conflict`)
