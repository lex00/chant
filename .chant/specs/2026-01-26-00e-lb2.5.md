---
type: code
status: completed
depends_on:
- 2026-01-26-00e-lb2.4
target_files:
- src/cmd/verify.rs
- src/main.rs
model: claude-haiku-4-5-20251001
---
# Implement agent invocation for verification with dry-run support

Implement the agent invocation logic that sends the spec body and acceptance criteria to the verify prompt. Parse the agent's response to extract PASS/FAIL/SKIP status for each criterion. Support `--dry-run` to show what would be verified without invoking the agent.

### Acceptance Criteria

- [x] Agent invoked with verify prompt, spec body, and acceptance criteria as context
- [x] Agent response parsed to extract verification result (PASS/FAIL/PARTIAL)
- [x] Individual criterion results (PASS/FAIL/SKIP) extracted from response
- [x] `--dry-run` flag prints specs that would be verified without invoking agent
- [x] Error handling for agent API failures or unexpected response formats

### Edge Cases

- Agent returns malformed response: Should display error and mark verification as FAILED
- Agent response missing some criteria: Should mark missing ones as SKIP
- Agent times out or returns error: Should fail verification gracefully with clear message
- Spec has no acceptance criteria section: Should skip verification with warning

### Example Test Cases

For this feature, verify:
- Agent receives correct prompt with spec context
- Response with all PASS criteria marks spec as PASSED
- Response with any FAIL criteria marks spec as FAILED
- `--dry-run` prints spec IDs but doesn't invoke agent