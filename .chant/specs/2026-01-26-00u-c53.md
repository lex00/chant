---
type: code
status: completed
target_files:
- src/cmd/spec.rs
completed_at: 2026-01-26T22:14:55Z
model: haiku
---
# Lint: refine coupling rule for drivers and members

## Context

Current coupling rule warns when any spec references another spec ID. But this is too strict:

- **Drivers** exist to coordinate member specs - they MUST reference them
- **Member specs** (.1, .2, etc.) should remain independent and NOT reference siblings

## Current Behavior

```
$ chant lint
⚠ driver-00x: References other specs: 00x.1, 00x.2, 00x.3
⚠ 00x.1: References other specs: 00x.2
```

Both warnings fire, but only the second is a real problem.

## Desired Behavior

```
$ chant lint
⚠ 00x.1: References sibling spec 00x.2 - member specs should be independent
```

Driver referencing its members: OK (expected)
Member referencing sibling: WARNING (coupling problem)

## Implementation

1. Detect if spec is a driver (type: driver or type: group)
2. If driver: skip coupling check entirely
3. If member spec (has .N suffix):
   - Extract driver ID
   - Warn if body references any sibling (same driver, different member number)
4. Regular specs: existing behavior (warn on any spec ID reference)

## Acceptance Criteria

- [ ] Drivers (type: driver/group) excluded from coupling check
- [ ] Member specs warned only for sibling references
- [ ] Regular specs warned for any spec ID reference (existing behavior)
- [ ] Tests for driver exclusion
- [ ] Tests for member-sibling detection