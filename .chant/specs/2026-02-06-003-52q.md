---
type: code
status: in_progress
depends_on:
- 2026-02-06-007-mrk
branch: chant/2026-02-06-003-52q
---
# Add multi-repo integration test

## Context
Multi-repo listing works via global config + `--global` flag, but has never been tested. This spec adds an integration test.

## Changes Required

### New file: `tests/test_multi_repo.rs`

Test scenario:
1. Create two temp git repos (using `tempfile::TempDir`)
2. Run `chant init` in each with different `project.name` values
3. Set up a global config file (in a temp location) listing both repos
4. Add specs to each repo using the library API (not CLI, to avoid path issues)
5. Verify `chant list --global` returns specs from both repos with repo prefixes
6. Verify spec IDs are independent (no sequence collision between repos)
7. Verify worktree paths would be different due to different project names

### Notes
- Look at existing integration tests in `tests/` for patterns
- May need to use `std::process::Command` to invoke chant CLI, or use library functions directly
- The global config path can be overridden via `CHANT_GLOBAL_CONFIG` env var (check config.rs)
- Each repo needs a git init + initial commit before `chant init` works

## Acceptance Criteria
- [x] Integration test creates two independent repos with `chant init`
- [x] Each repo gets specs added independently
- [x] Test verifies spec IDs don't collide between repos
- [x] Test verifies worktree path namespacing produces different paths per project
- [x] Test cleans up temp directories
- [x] `cargo test test_multi_repo` passes
- [x] Test does not interfere with other tests (no shared state)

## Output



## Dependencies
- depends_on: [2026-02-06-002-826]