---
type: code
status: completed
model: claude-opus-4-5-20251101
---
# Add shell autocomplete support for chant CLI

## Problem

Chant CLI has 41 commands with many options, making it difficult for users to remember all available commands and flags. Shell autocomplete would significantly improve the user experience by:

- Helping users discover available commands
- Preventing typos in command names
- Showing available flags and options
- Completing spec IDs from the actual specs in `.chant/specs/`
- Supporting bash, zsh, fish, and PowerShell

## Solution

Implement shell autocomplete using clap's built-in completion generation:

1. **Add completion generation command:**
   ```bash
   chant completion <shell>
   ```
   Generates completion script for bash, zsh, fish, or powershell.

2. **Support shells:**
   - bash
   - zsh
   - fish
   - PowerShell

3. **Dynamic completions:**
   - Spec IDs: Complete from actual spec files in `.chant/specs/`
   - Prompt names: Complete from `.chant/prompts/*.md`
   - Branch names: Complete from `git branch` output
   - Labels: Complete from existing spec labels

4. **Installation instructions:**
   - Update README and docs with installation steps for each shell
   - Example for bash: `chant completion bash > /usr/local/etc/bash_completion.d/chant`
   - Example for zsh: `chant completion zsh > ~/.zsh/completion/_chant`

## Implementation Notes

Clap provides automatic completion via `clap_complete`:

```rust
use clap::CommandFactory;
use clap_complete::{generate, Shell};

// In main.rs, add new Completion command:
#[derive(Subcommand)]
enum Commands {
    // ... existing commands

    /// Generate shell completion script
    Completion {
        /// Shell to generate completions for
        #[arg(value_enum)]
        shell: Shell,
    },
}

// Handler:
Commands::Completion { shell } => {
    let mut cmd = Cli::command();
    generate(shell, &mut cmd, "chant", &mut io::stdout());
}
```

For dynamic completions (spec IDs, etc.), use `clap_complete::dynamic` or custom completion logic.

## Acceptance Criteria

- [x] Add `clap_complete` dependency to Cargo.toml
- [x] Implement `chant completion <shell>` command in src/main.rs
- [x] Support bash, zsh, fish, powershell
- [x] Test completion generation for each shell
- [x] Add installation instructions to README.md
- [x] Add detailed completion setup guide to docs/
- [x] Test dynamic spec ID completion works
- [x] All tests passing
- [x] Code linted and formatted