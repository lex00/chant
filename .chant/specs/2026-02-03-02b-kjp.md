---
type: code
status: in_progress
---
# Add tests for MCP server handlers

## Context

MCP handlers in `src/mcp/handlers.rs` have 19.3% coverage. These handle all MCP tool calls.

## Target file

`tests/test_mcp_handlers.rs` (new file)

## Tests to add

1. **spec_list** - Test filtering by status, limit parameter, empty results
2. **spec_get** - Test valid ID, partial ID, nonexistent ID
3. **spec_update** - Test status change, output append, invalid transitions
4. **work_start** - Test starting spec, already running spec, invalid spec
5. **work_list** - Test with running processes, no processes, include_completed
6. **ready** - Test with dependencies, no ready specs, limit parameter
7. **status** - Test brief mode, include_activity, counts accuracy
8. **log** - Test lines param, offset param, since param, nonexistent spec
9. **verify** - Test all criteria checked, partial, none checked
10. **Error handling** - Test malformed requests, missing params

## Acceptance criteria

- [x] Create `tests/test_mcp_handlers.rs` with test module
- [x] Add tests for spec_list, spec_get, spec_update handlers
- [x] Add tests for work_start, work_list handlers
- [x] Add tests for ready, status, log, verify handlers
- [x] `cargo test test_mcp_handlers` passes