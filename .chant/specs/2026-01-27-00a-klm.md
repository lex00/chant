---
type: code
status: completed
target_files:
- src/cmd/spec.rs
- src/cmd/lifecycle.rs
- src/main.rs
commits:
- 8a41ffd
completed_at: 2026-01-27T16:56:11Z
model: haiku
---
# Lint checks for unchecked criteria, add chant finalize command

## Problem

Agents complete work but forget to:
1. Check off acceptance criteria boxes (`- [ ]` â†’ `- [x]`)
2. Update spec status to `completed`

The current unchecked criteria check happens AFTER agent exits - too late to fix.

## Solution

### Part 1: Enhance `chant lint`

Add validation to `chant lint`:
- If spec has `status: completed` or `status: in_progress` but has unchecked `- [ ]` boxes, warn
- Message: "Spec has N unchecked acceptance criteria"

This lets agents run `just lint` before finishing and catch the issue.

### Part 2: Add `chant finalize <spec-id>`

New command that:
1. Validates all `- [ ]` are checked (fails if not)
2. Updates `status: completed` in frontmatter
3. Adds `model: <model>` to frontmatter (from env or config)
4. Adds commit hash if there's an uncommitted chant commit

This gives agents a single command to properly complete a spec.

## Acceptance Criteria

- [x] `chant lint` warns on completed/in_progress specs with unchecked criteria
- [x] `chant finalize <spec-id>` command added
- [x] Finalize fails with clear error if criteria unchecked
- [x] Finalize updates status to completed
- [x] Finalize adds model to frontmatter
- [x] Agent docs updated to use `chant finalize`
- [x] `just lint` passes
- [x] `just test` passes