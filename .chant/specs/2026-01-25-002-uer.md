---
type: research
status: pending
target_files:
- src/main.rs
- src/diagnose.rs
---
# Investigate uncommitted formatting changes - ensure fmt runs before commit

## Problem

After working specs, `src/diagnose.rs` had uncommitted formatting changes that should have been applied before the commit. This suggests:
1. Code was written without running `cargo fmt`
2. The commit was created before formatting was applied
3. User left with dirty working tree

## Questions to Answer

1. Where in the chant workflow should `cargo fmt` run?
   - Before commit in finalize_spec()?
   - As a pre-commit hook?
   - Agent should run it as part of workflow?

2. Should chant automatically run `cargo fmt` before committing?
   - Pro: Ensures consistent formatting
   - Con: May be slow, may conflict with user preferences

3. Should this be configurable?
   - Add `auto_format: true` to chant config?
   - Respect existing pre-commit hooks?

4. What about other linting (clippy)?
   - Should clippy also run before commit?
   - Or just rely on CI?

## Acceptance Criteria

- [ ] Investigate where formatting should occur in chant workflow
- [ ] Determine if auto-formatting should be built into chant
- [ ] Recommend solution (auto-format, pre-commit hook, or agent responsibility)
- [ ] If implementing: ensure all code changes are formatted before commit
- [ ] Document decision in findings
