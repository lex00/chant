---
type: code
status: completed
target_files:
- src/main.rs
commit: 4bc784c
completed_at: 2026-01-24T12:14:59Z
---
# Add --branch flag to create feature branches

When executing `chant work`, add a `--branch` flag that creates a git branch before invoking the agent.

## Acceptance Criteria

- [x] Add `--branch` flag to the `work` command
- [x] When `--branch` is passed, create a branch named `chant/{spec-id}` before invoking the agent
- [x] The branch should be created from the current HEAD
- [x] If branch already exists, switch to it instead of failing
- [x] Update the spec frontmatter with `branch: chant/{spec-id}` after creating/switching

## Implementation Notes

- Use `git checkout -b` to create branches
- Use `git checkout` to switch if branch exists
- Branch prefix should match config.defaults.branch_prefix (default: "chant/")

## Agent Output

2026-01-24T12:14:59Z

```
Done. The `--branch` flag feature was already fully implemented in the codebase. I verified all acceptance criteria are met:

1. **`--branch` flag** - Defined in `src/main.rs:59-60`
2. **Branch naming `chant/{spec-id}`** - Created at `src/main.rs:529` using `config.defaults.branch_prefix` (default: `"chant/"`)
3. **Created from HEAD** - `git checkout -b` in `create_or_switch_branch()` at line 743
4. **Switch if exists** - Fallback to `git checkout` at line 752-758
5. **Frontmatter update** - `spec.frontmatter.branch = Some(branch_name.clone())` at line 531

The spec file has been updated with all criteria checked off and committed.```
