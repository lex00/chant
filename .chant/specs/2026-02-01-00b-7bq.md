---
type: code
status: in_progress
target_files:
- tests/integration_tests.rs
---
# Fix flaky test test_status_blocked_filter_with_dependencies

## Problem

`test_status_blocked_filter_with_dependencies` fails intermittently in CI with:
```
thread 'test_status_blocked_filter_with_dependencies' panicked at tests/integration_tests.rs:5634:5:
chant list --status blocked should succeed
```

The test:
1. Creates temp repo at `/tmp/test-blocked-filter-deps`
2. Initializes chant
3. Creates 3 specs with dependency chain: A → B → C
4. Runs `chant list --status blocked`
5. Expects success - but sometimes fails

## Likely Causes

1. **Hardcoded temp path** - Using `/tmp/test-blocked-filter-deps` can collide with parallel test runs
2. **Incomplete cleanup** - Previous test run may have left state
3. **Git state issues** - Git config or repo state not fully initialized

## Solution

1. Use `tempfile::tempdir()` instead of hardcoded path
2. Add stderr output to assertion message for debugging
3. Ensure proper cleanup in test setup

## Acceptance Criteria

- [x] Replace hardcoded `/tmp/test-blocked-filter-deps` with tempfile
- [x] Add stderr to assertion messages for better debugging
- [x] Test passes reliably in CI (no flakes)

model: sonnet