---
type: code
status: pending
target_files:
  - src/cmd/merge.rs
  - src/main.rs
---

# Selective merge command - merge specific completed branches from parallel work

## Problem

After parallel execution, some specs complete successfully while others fail or need attention. Currently:
- `chant merge` merges ALL pending branches
- No way to merge just specific completed specs
- No visibility into which branches are ready vs stuck

Users want to:
1. See which branches are ready to merge
2. Selectively merge specific specs
3. Leave problematic branches for later

## Solution

Enhance `chant merge` with:
1. List mode showing branch status
2. Selective merge by spec ID
3. Interactive mode to choose which to merge

## Implementation

### List mode

```bash
$ chant merge --list

Ready to merge:
  chant/2026-01-31-001-abc  (3 commits, all criteria met)
  chant/2026-01-31-002-def  (1 commit, all criteria met)

Not ready:
  chant/2026-01-31-003-ghi  (behind main, needs rebase)
  chant/2026-01-31-004-jkl  (2/5 criteria checked)
```

### Selective merge

```bash
# Merge specific specs
chant merge abc def

# Merge all ready branches
chant merge --ready
```

### Interactive mode

```bash
$ chant merge -i

Select branches to merge:
  [x] 2026-01-31-001-abc - Implement feature (ready)
  [x] 2026-01-31-002-def - Fix bug (ready)
  [ ] 2026-01-31-003-ghi - Add tests (needs rebase)
  [ ] 2026-01-31-004-jkl - Update docs (incomplete)

Merge 2 selected branches? (y/n)
```

### Branch status detection

For each chant/* branch, determine:
- **ready**: All criteria checked, can ff-merge
- **needs-rebase**: Behind main, auto-rebase possible
- **has-conflicts**: Rebase would conflict
- **incomplete**: Criteria not all checked
- **no-commits**: Branch exists but no work done

## Acceptance Criteria

- [ ] Add `--list` flag to show branch status
- [ ] Detect branch readiness (criteria, ff-ability, divergence)
- [ ] Allow spec IDs as positional args for selective merge
- [ ] Add `--ready` flag to merge all ready branches
- [ ] Add `-i` interactive mode with checkbox selection
- [ ] Show clear status for each branch
- [ ] Skip branches that aren't ready (with explanation)
- [ ] Report results: merged, skipped, failed
