---
type: code
status: in_progress
---
# chant work shows lint warning before failing on existing branch

## Problem

When running `chant work`, if the user aborts at the quality check prompt (answers "N"), the branch AND worktree have already been created and are left behind. Subsequent runs fail with "Branch already exists", and cleanup requires `git worktree remove` before `git branch -D`.

## Root Cause

In `src/cmd/work/single.rs`:
- Line 416: `worktree::create_worktree` creates branch AND worktree FIRST
- Lines 439-517: Quality check happens AFTER

## Fix

In `src/cmd/work/single.rs`, move the quality check block (lines 439-517) to BEFORE the worktree creation block (lines 409-423).

## Acceptance Criteria

- [x] In `src/cmd/work/single.rs`, the `traffic_light` quality check appears before `worktree::create_worktree` call
- [x] `grep -n "traffic_light\|create_worktree" src/cmd/work/single.rs` shows traffic_light line < create_worktree line
- [x] `cargo check` compiles without errors
- [x] `cargo test cmd::work` passes