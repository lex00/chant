---
type: code
status: pending
---
# chant work shows lint warning before failing on existing branch

## Output

## Problem

When running `chant work`, if the user aborts at the quality check prompt (answers "N"), the branch/worktree has already been created and is left behind. Subsequent runs fail with "Branch already exists".

## Root Cause

In `src/cmd/work/single.rs`:
- Line 416: `worktree::create_worktree` creates the branch FIRST
- Lines 439-517: Quality check happens AFTER

The quality check should happen BEFORE creating the branch/worktree.

## Fix

In `src/cmd/work/single.rs`, move the quality check block (lines 439-517) to BEFORE the worktree creation block (lines 409-423).

## Acceptance Criteria

- [ ] Quality check runs before `worktree::create_worktree` is called
- [ ] User can abort at quality prompt without leaving orphan branches
- [ ] `cargo test` passes
- [ ] `cargo check` passes

## Output

## Problem

When running `chant work`, if the user aborts at the quality check prompt (answers "N"), the branch AND worktree have already been created and are left behind. Subsequent runs fail with "Branch already exists", and cleanup requires `git worktree remove` before `git branch -D`.

## Root Cause

In `src/cmd/work/single.rs`:
- Line 416: `worktree::create_worktree` creates branch AND worktree FIRST
- Lines 439-517: Quality check happens AFTER

The quality check should happen BEFORE creating the branch/worktree.

## Fix

In `src/cmd/work/single.rs`, move the quality check block (lines 439-517) to BEFORE the worktree creation block (lines 409-423).

## Acceptance Criteria

- [ ] Quality check runs before `worktree::create_worktree` is called
- [ ] User can abort at quality prompt without leaving orphan branches/worktrees
- [ ] `cargo test` passes
- [ ] `cargo check` passes
