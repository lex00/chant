---
type: code
status: pending
target_files:
  - src/cmd/spec.rs
  - .chant/prompts/split.md
---

# Enhance split with linting-aware decomposition

## Context

Split was considered for removal, but with new linting rules (complexity, coupling, model waste), split becomes more valuable as the *solution* when lint identifies problems.

Supersedes: 00b-16v, 00c-zoe (split removal specs - now cancelled)

## Integration with Linting

When `chant lint` warns about complexity, split should be the recommended fix:

```
$ chant lint
⚠ 00x-abc: Too complex (8 criteria, 6 files, 650 words)
  → Consider: chant split 00x-abc
```

## Split Enhancements

### 1. Use complexity thresholds as targets

Split should aim to produce specs that pass lint:
- Each resulting spec: ≤5 acceptance criteria
- Each resulting spec: ≤5 target files
- Each resulting spec: ≤200 words (haiku-friendly)

### 2. Enforce independence

Resulting specs should not reference each other:
- No spec ID cross-references in body
- Separate target_files (no overlap unless necessary)
- Each spec self-contained

### 3. Suggest appropriate model

Simple resulting specs should default to haiku:
- Don't set `model:` in frontmatter (uses default)
- Only suggest opus/sonnet if complexity warrants it

### 4. Lint integration in workflow

```
$ chant split 00x-abc
Analyzing spec complexity...
  Current: 8 criteria, 6 files, 650 words (too complex for haiku)

Splitting into 3 haiku-friendly specs...
  00x-abc.1: Add user authentication (3 criteria, 2 files)
  00x-abc.2: Add session management (3 criteria, 2 files)
  00x-abc.3: Add logout flow (2 criteria, 2 files)

All resulting specs pass complexity checks ✓
```

## Acceptance Criteria

- [ ] Split prompt updated with complexity thresholds
- [ ] Split output shows complexity analysis
- [ ] Resulting specs target ≤5 criteria, ≤5 files, ≤200 words each
- [ ] Resulting specs don't cross-reference each other
- [ ] Lint suggests split for complex specs
- [ ] Tests for linting-aware split
