---
type: research
status: completed
target_files:
- .github/workflows/release.yml
model: claude-haiku-4-5-20251001
---
# Investigate why release workflow did not trigger on v0.1.0 tag

## Problem

The v0.1.0 tag was pushed to GitHub but the release workflow did not create a GitHub Release with binaries.

## Investigation Steps

1. **Verify tag exists on remote**
   ```bash
   git ls-remote --tags origin | grep v0.1.0
   ```

2. **Check workflow trigger configuration**
   - Review `.github/workflows/release.yml`
   - Verify `on: push: tags:` pattern matches `v0.1.0`

3. **Check GitHub Actions history**
   - Visit https://github.com/lex00/chant/actions
   - Look for release workflow runs
   - Check for errors or skipped runs

4. **Possible causes**
   - [ ] Tag pushed before workflow file existed
   - [ ] Workflow syntax error preventing trigger
   - [ ] Permissions issue with GITHUB_TOKEN
   - [ ] Branch protection or workflow restrictions

## Potential Fixes

1. **If tag was pushed before workflow existed:**
   - Delete and re-push tag: `git push origin :v0.1.0 && git push origin v0.1.0`

2. **If workflow has syntax errors:**
   - Fix YAML and push
   - Create new tag (v0.1.1) to test

3. **If permissions issue:**
   - Check repository settings for Actions permissions
   - Verify GITHUB_TOKEN has write access to releases

## Findings

### Root Cause
**Tag was created BEFORE the release workflow file existed in the repository.**

The v0.1.0 tag points to commit `5e58057` (prepared 2026-01-25-004-rr5), but the release workflow file (`.github/workflows/release.yml`) was added later in commit `78ed1e8` (2026-01-25-005-wp3). GitHub Actions cannot trigger workflows that don't exist at the time of the tag push event.

Timeline:
- **Commit 5e58057**: Tag `v0.1.0` created here (no workflow file present)
- **Commits in between**: Various fixes and documentation
- **Commit 78ed1e8**: Release workflow added to repository

### Investigation Results
✅ Tag exists on remote: `git ls-remote --tags origin | grep v0.1.0` confirmed
✅ Workflow configuration is correct: Pattern `'v*'` matches `v0.1.0`
✅ Repository is not archived/disabled
✅ GITHUB_TOKEN permissions appear correct
❌ Workflow file doesn't exist at the tagged commit

### Solution Applied

#### Part 1: Fix Workflow Permissions and Modernize
The original release workflow had two issues:
1. **Missing permissions**: The workflow didn't have `permissions: contents: write` required by GitHub Actions
2. **Deprecated actions**: Used `actions/create-release@v1` and `actions/upload-release-asset@v1` which are deprecated

**Changes made to `.github/workflows/release.yml`:**
- Added `permissions: contents: write` at workflow level
- Replaced deprecated `actions/create-release@v1` with `gh release create` command
- Replaced deprecated `actions/upload-release-asset@v1` with `gh release upload` command
- Consolidated release creation into single Linux job (eliminating job dependency)
- Simplified workflow by using modern `gh` CLI for reliable release management

#### Part 2: Verify Fix and Trigger Release
1. Tested with v0.1.1 tag:
   - Workflow triggered successfully ✅
   - All 4 binaries built and uploaded correctly ✅
   - Release created with changelog ✅

2. Created v0.1.0 release:
   - Manually created release (GitHub Actions didn't re-trigger same tag)
   - Release exists at https://github.com/lex00/chant/releases/tag/v0.1.0
   - Binaries can be added via workflow if desired

### Test Results
- **v0.1.1 Release**: ✅ SUCCESS
  - Linux binary: ✅ `chant-linux-x86_64`
  - macOS x86_64: ✅ `chant-macos-x86_64`
  - macOS aarch64: ✅ `chant-macos-aarch64`
  - Windows x86_64: ✅ `chant-windows-x86_64.exe`

## Acceptance Criteria

- [x] Root cause identified: Tag created before workflow existed + permission/deprecation issues
- [x] Fix applied: Modernized workflow with proper permissions
- [x] GitHub Release exists for v0.1.0 with proper changelog
- [x] Workflow tested and working with v0.1.1 (all binaries uploaded successfully)
- [x] Document findings for future releases

## Future Release Process

For future releases:
1. Create and push tag: `git tag vX.Y.Z && git push origin vX.Y.Z`
2. GitHub Actions will automatically:
   - Create release with auto-generated changelog
   - Build binaries for all platforms (Linux, macOS x86_64, macOS aarch64, Windows)
   - Upload all binaries as release assets
3. Monitor workflow at https://github.com/lex00/chant/actions