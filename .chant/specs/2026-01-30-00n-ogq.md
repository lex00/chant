---
type: code
status: in_progress
labels:
- refactor
- cleanup
target_files:
- src/spec_group.rs
---
# Cleanup debug output and audit dead code

## Problem

1. Debug `eprintln!` statements in `src/spec_group.rs` should be removed or converted to proper logging
2. 24+ `#[allow(dead_code)]` suppressions across the codebase need auditing

## Solution

1. Remove all debug `eprintln!("[DEBUG]` statements from `spec_group.rs`
2. Audit each `#[allow(dead_code)]` suppression:
   - If the code is actually unused, remove it
   - If the code is used, remove the suppression
   - If kept for future use, add a comment explaining why

## Acceptance Criteria

- [x] Remove all `eprintln!("[DEBUG]` statements from `spec_group.rs`
- [x] Audit each `#[allow(dead_code)]` - remove unused code or remove suppression if actually used
- [x] Document any dead code kept intentionally (for future use)
- [x] All tests pass
- [x] No new clippy warnings

## Changes Made

### Debug output removed:
- Removed all `eprintln!("[DEBUG]` statements from `src/spec_group.rs` (in `mark_driver_in_progress` and `auto_complete_driver_if_ready`)

### Dead code suppressions removed (code is actually used):
- `src/config.rs:256` - `prefix` field (used in `load_merged_from`)
- `src/config.rs:275` - `main_branch` field (used in merge.rs, lifecycle.rs)
- `src/git.rs:445` - `format_merge_summary()` (used in cmd/lifecycle.rs)
- `src/worktree.rs:180` - `success` field (used in cmd/work.rs)
- `src/spec.rs:692` - `apply_blocked_status_with_repos()` (called by `apply_blocked_status`)
- `src/cmd/work.rs:1440` - `ParallelResult` struct (extensively used)
- `src/cmd/work.rs:2520,2526` - `pitfall_type` and `PitfallType` (used in tests)
- `src/cmd/verify.rs:44` - `SpecVerificationResult` struct (used internally)

### Unused code removed:
- `src/cmd/git_ops.rs:44` - `push_branch()` function
- `src/cmd/finalize.rs:316` - `replay_finalize_spec()` function
- `src/cmd/agent.rs:112` - `invoke_agent_with_prefix()` function (superseded by `invoke_agent_with_command`)
- `tests/integration_tests.rs:63` - `create_spec_file()` test helper

### Dead code kept with documentation (for future use):
- `src/templates.rs:41` - `supports_mcp()` - Used in tests
- `src/provider.rs:84` - `fn name()` - Trait method used in tests
- `src/diagnose.rs:61,66` - `all_passed()`, `failed_checks()` - Public API for tests
- `src/agent.rs:68` - `role` field - Required for serde deserialization
- `src/merge.rs:87` - `validate_spec_can_merge()` - Public API used in tests
- `src/cmd/activity.rs:52` - `commit` field - For deduplication/debugging
- `src/cmd/commits.rs:737` - `commit_hash` field - For debugging/future tooling
- `src/cmd/commits.rs:819,851` - Agent detection functions - For future approval workflow
- `src/cmd/verify.rs:45-48` - `spec_id`, `spec_title`, `total_criteria` fields - For future detailed output
- `src/cmd/work.rs:2519` - `pitfall_type` field - Used in tests
- `src/cmd/work.rs:2528` - `UncommittedChanges` variant - Reserved for future detection
- `tests/integration_tests.rs` - Conflict resolution test helpers - For future tests