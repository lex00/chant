---
type: code
status: in_progress
depends_on:
- 2026-01-30-00e-y44.3
target_files:
- src/score/confidence.rs
---
# Confidence Scoring Implementation

Implement scoring based on spec structure, bullet quality, and vague language.

### Inherited Context

- Good specs: bulleted lists, imperative verbs, specific language
- Bad specs: walls of prose, vague phrases like "improve", "as needed"

### Acceptance Criteria

- [x] Implement `calculate_confidence(spec: &Spec, config: &Config) -> ConfidenceGrade` function
- [x] Calculate bullet-to-prose ratio (bullet lines / paragraph lines)
- [x] Detect imperative verbs starting bullets (implement, add, create, update, fix, etc.)
- [x] Detect vague language using vague pattern detection
- [x] Grade A: High bullet ratio (>80%), verbs in >80% bullets, no vague patterns
- [x] Grade B: Medium bullet ratio (>50%), verbs in >50% bullets, <3 vague patterns
- [x] Grade C: Low bullet ratio (>20%), verbs in >30% bullets, 3-5 vague patterns
- [x] Grade D: Very low bullet ratio (<20%) OR >5 vague patterns

### Edge Cases

- Specs with no body text should default to Grade D
- Empty bullets should not count toward bullet ratio
- Multiple vague patterns in one line count separately

### Example Test Cases

- Spec with 10 bullet points, 2 paragraphs, no vague language → Grade A
- Spec with 5 bullets, 5 paragraphs, 2 vague patterns → Grade B
- Spec with 1 paragraph, 10 lines, 6 vague patterns → Grade D

### Requires

- Uses `detect_vague_patterns()` from Member 3

### Provides

- `calculate_confidence(spec: &Spec, config: &Config) -> ConfidenceGrade` - Returns grade based on structure/clarity