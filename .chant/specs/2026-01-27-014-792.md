---
type: code
status: completed
model: claude-opus-4-5-20251101
---

# Warn when parallel execution ignores model/prompt config due to agent profiles

## Problem

When using `--prompt` flag with parallel execution, users may expect the prompt choice to influence which model is used, but it's **silently ignored** because each agent command (`claude2`, `claude3`) has its own CLI profile with its own model.

**User Experience:**
```bash
$ chant work --parallel --prompt research-analysis
# User might expect this research prompt to use opus (smarter model)
# But it uses whatever model is in claude2/claude3 profiles (e.g., haiku)
# No warning shown that prompt doesn't control model selection
```

**Confusion:**
- User runs `chant work --parallel --prompt <name>`
- They might expect different prompts to use different models (e.g., "complex-task" → opus, "simple-fix" → haiku)
- The prompt file IS used (for instructions), but model selection comes from agent CLI profiles
- No indication that `--prompt` doesn't control model selection in parallel mode

**Root Cause:**
- In `cmd_work_parallel()`, agent commands are selected from `config.parallel.agents`
- Each agent has its own `command` (e.g., `claude2`, `claude3`)
- Those commands have their own CLI profiles: `~/.config/claude2/config.yaml`
- The profile's `model:` setting overrides everything

## Solution

Add a warning when parallel execution uses agent rotation and the user has set model preferences that will be ignored.

## Acceptance Criteria

- [x] Detect when user has set model preferences (env vars or config)
- [x] Detect when parallel execution uses agent rotation
- [x] Print warning explaining the override behavior
- [x] List which agents will be used and where their config comes from
- [x] Show exact commands to update agent models
- [x] Only show warning once at start of parallel execution
- [x] Warning appears before "Starting N specs in parallel" message
- [x] Add test: parallel with CHANT_MODEL set → shows warning
- [x] Add test: parallel with rotation_strategy: none → no warning
- [x] All existing tests pass
