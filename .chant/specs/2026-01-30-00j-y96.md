---
type: code
status: completed
labels:
- cursor-integration
- enhancement
target_files:
- src/cmd/site.rs
- src/cmd/mod.rs
- src/main.rs
- src/site/mod.rs
- src/site/graph.rs
- src/site/timeline.rs
- src/site/theme.rs
- src/config.rs
- src/spec.rs
- src/lib.rs
- templates/site/base.html
- templates/site/index.html
- templates/site/spec.html
- templates/site/status-index.html
- templates/site/label-index.html
- templates/site/timeline.html
- templates/site/graph.html
- templates/site/changelog.html
- templates/site/styles.css
commits:
- 7b5b4c7
completed_at: 2026-01-30T15:38:50Z
model: opus
---
# Site documentation generation from specs

## Problem

Chant specs are well-structured markdown with YAML frontmatter. Users want to publish spec documentation as browsable websites for team visibility, project history, and stakeholder communication.

## Solution

Built-in static site generator with:
- **Tera templates** for user-customizable themes
- **ASCII graphs** for dependency visualization (no JavaScript)
- **Multi-page structure** with configurable content
- **Embedded default theme** with easy customization path

## Commands

```bash
chant site init                    # Copy theme to .chant/site/theme/
chant site build --output ./public/  # Generate static HTML
chant site serve --port 3000       # Local preview server
```

## Architecture

### Template Engine: Tera
- Jinja2-like syntax (widely known)
- Runtime template loading (users edit without recompiling chant)
- ~500KB binary size impact

### ASCII Graphs
No JavaScript. Server-side generated box-drawing characters:

```
┌─────────────┐
│ 00a-xyz     │
│ Auth setup  │
└──────┬──────┘
       │
       ▼
┌─────────────┐     ┌─────────────┐
│ 00b-abc     │────▶│ 00c-def     │
│ OAuth       │     │ API keys    │
└─────────────┘     └─────────────┘
```

Graph detail level configurable: IDs only, +titles, +status, +labels.

### ASCII Timeline

```
2026-01-30
├── ✓ 00d-vao  Spec Templates (completed)
├── ◐ 00e-y44  Complexity Scoring (in_progress)
└── ○ 00f-gqz  Cost Tracking (pending)

2026-01-29
├── ✓ 00a-xyz  Auth setup
└── ✓ 00b-abc  OAuth integration
```

## Theme Customization

`chant site init` copies full theme to `.chant/site/theme/`:

```
.chant/site/theme/
├── base.html          # Page skeleton, head, nav
├── spec.html          # Individual spec page
├── index.html         # Main index page
├── status-index.html  # By-status listing
├── label-index.html   # By-label listing
├── timeline.html      # Timeline view
├── graph.html         # Dependency graph view
├── changelog.html     # Changelog view
└── styles.css         # All styling
```

Users edit templates directly. No partial override magic - explicit and visible.

## Configuration

```yaml
# In config.md
site:
  output_dir: ./public/
  base_url: /specs/
  title: "Project Specs"

  # Content filtering
  include:
    statuses: [completed, in_progress, pending]
    labels: []  # empty = all
  exclude:
    labels: [internal, wip]
    fields: [cost_usd, tokens]  # Redact from output

  # Spec-level override
  # In spec frontmatter: `public: false` excludes from site

  # Features (all default true except noted)
  features:
    changelog: true
    dependency_graph: true
    timeline: true
    status_indexes: true
    label_indexes: true

  # Graph options
  graph:
    detail: full  # minimal | titles | full
    # minimal: IDs only
    # titles: IDs + titles
    # full: IDs + titles + status + labels

  # Timeline options
  timeline:
    group_by: day  # day | week | month
    include_pending: false
```

## Output Structure

```
public/
├── index.html              # Main landing
├── specs/
│   ├── 2026-01-30-00a-xyz.html
│   ├── 2026-01-30-00b-abc.html
│   └── ...
├── status/
│   ├── completed.html
│   ├── in-progress.html
│   └── pending.html
├── labels/
│   ├── auth.html
│   ├── api.html
│   └── ...
├── timeline.html
├── graph.html
├── changelog.html
└── styles.css
```

## Privacy Controls

### Spec-level exclusion
```yaml
# In spec frontmatter
public: false  # Excluded from site generation
```

### Field redaction
Configure in `site.exclude.fields` - those fields stripped from output.

### Label-based filtering
`site.exclude.labels: [internal]` - specs with that label excluded.

## Acceptance Criteria

### Core
- [x] `chant site init` creates `.chant/site/theme/` with default templates
- [x] `chant site build` generates static HTML to output directory
- [x] `chant site serve` starts local HTTP server for preview
- [x] Tera template engine integration
- [x] Embedded default theme (CSS + templates compiled into binary)

### Pages
- [x] Individual spec pages with full content
- [x] Main index page listing all included specs
- [x] Status index pages (completed, in-progress, pending)
- [x] Label index pages (one per label)
- [x] Timeline page with ASCII timeline
- [x] Graph page with ASCII dependency graph
- [x] Changelog page grouped by date

### ASCII Visualizations
- [x] Dependency graph using box-drawing characters
- [x] Graph detail levels: minimal, titles, full
- [x] Timeline with tree structure (├── └──)
- [x] Timeline grouping: day, week, month

### Configuration
- [x] Site config section in config.md
- [x] Include/exclude by status and label
- [x] Field redaction (exclude.fields)
- [x] `public: false` frontmatter support
- [x] Feature toggles for each page type
- [x] Graph and timeline options

### Theme System
- [x] Templates loaded from `.chant/site/theme/` if present
- [x] Falls back to embedded defaults if no theme directory
- [x] Template variables documented

## Future Considerations (Deferred)

- Search functionality (client-side index)
- RSS/Atom feed for completed specs
- PDF export
- Multi-project aggregation
- Custom pages (user-authored markdown)

## Agent Output

2026-01-30T15:38:50Z

```
I'll start by reading the spec file and understanding the codebase structure to plan my implementation approach.
Now I have a clear understanding of the codebase. Let me create a todo list and start implementing the site command.
Let me read the key files I'll need to modify:
Let me read spec.rs in parts and also look at the existing modules:
Now I have a good understanding of the structure. Let me also read more of main.rs to see the rest of the command dispatch and look at lib.rs for the path constants:
Now I have a complete picture of the codebase. Let me start implementing. I'll begin with the todo list updates and the first items:
Now let me add the site config structures to config.rs. First, I need to read more of the file to see where to add them:
Now I'll add the site config structures to config.rs. I'll add the site field to the Config struct and all the necessary types:
Now I need to update the PartialConfig struct to include site, and update the merge logic:
Now I need to find and update the merge_with function to include the site field:
Now let me add the `public` field to the spec frontmatter in spec.rs:
Now let me create the templates directory for site templates and the embedded theme files. First, let me check the templates directory structure:
I'll create the site templates in a new `templates/site` directory:
Now let me create the embedded theme templates. I'll create all the necessary template files:
Now let me create the site module in src/site. I'll create the main module file and the supporting files:
Now let me create the command module for site:
Now I need to add the site module to lib.rs:
Now I need to update main.rs to add the Site command and subcommands. Let me read the end of main.rs to see where I should add the command:
Now I'll add the Site command to the Commands enum and SiteCommands enum, then add the dispatch logic. First, let me add the command to the enum:
Now add the SiteCommands enum:
Now I need to add the dispatch logic for the Site command. Let me find where the Completion command is dispatched:
Now let's run cargo fmt and cargo clippy to fix formatting and any issues:
Now let's run clippy:
I need to fix the lifetime issue. Let me fix the code:
I need to import the Datelike trait in timeline.rs:
Now let me also fix the unused imports in mod.rs:
Let me fix these clippy warnings:
Now let me fix the slugify function:
Now let me fix the cmd/site.rs warnings:
Now let me fix the match statement for file path resolution:
Code compiles with no errors or warnings. Let me update the todos and run tests:
I need to add the `site` field to the test Config structs. Let me find and fix those:
All tests pass. Now let me update the todo list and check off the acceptance criteria in the spec file:
Now let me read the spec file and check off all the acceptance criteria:
Now let me update the spec with checked acceptance criteria and add the model field:
Now let me verify the build works and then commit:
Let me also verify the commands work:
Now let me check git status and commit the changes:
I have successfully implemented the site documentation generation feature. Here's a summary of what was done:

## Summary

### New Commands
- `chant site init` - Initializes the theme directory at `.chant/site/theme/` with customizable templates
- `chant site build` - Generates static HTML documentation to the output directory
- `chant site serve` - Starts a local HTTP server for previewing the generated site

### Key Features Implemented

**Core:**
- Tera template engine integration for user-customizable themes
- Embedded default theme (CSS + templates compiled into binary)
- Full static site generation pipeline

**Pages Generated:**
- Individual spec pages with full markdown content rendered to HTML
- Main index page with spec statistics
- Status index pages (completed, in-progress, pending)
- Label index pages (one per unique label)
- Timeline page with ASCII tree visualization
- Dependency graph page with ASCII box-drawing characters
- Changelog page grouped by completion date

**ASCII Visualizations:**
- Dependency graphs using box-drawing characters (┌─┐│└─┘▼)
- Three detail levels: minimal (IDs only), titles, full (IDs + titles + status + labels)
- Timeline with tree structure (├── └──)
- Timeline grouping options: day, week, month

**Configuration:**
- Site config section added to `config.md` frontmatter
- Include/exclude by status and label
- Field redaction via `exclude.fields`
- `public: false` frontmatter support for individual spec exclusion
- Feature toggles for each page type
- Graph and timeline visualization options

**Theme System:**
- Templates loaded from `.chant/site/theme/` if present
- Falls back to embedded defaults if no theme directory
- Template variables fully documented in `theme.rs`

### Files Created/Modified
- **New files:** `src/cmd/site.rs`, `src/site/mod.rs`, `src/site/graph.rs`, `src/site/timeline.rs`, `src/site/theme.rs`, and all tem

... (output truncated, 5217 chars total)```
