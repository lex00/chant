---
type: code
status: in_progress
target_files:
- src/main.rs
- src/config.rs
- .chant/config.md
- .chant/.gitignore
- CLAUDE.md
- docs/reference/config.md
model: claude-opus-4-5-20251101
---
# Implement agent config separation (no migration needed)

## Problem

`.chant/config.md` mixes project settings (should be in git) with agent configs (should not be in git). Since chant has no external users yet, we can fix this properly without migration complexity.

## Solution

**Simple breaking change (pre-release, no users affected):**

### 1. Remove agents from project config template

Update `src/main.rs` init template:
- Remove `parallel:` section with agents from `.chant/config.md` template
- Add `agents.md` to `.chant/.gitignore` template
- Show message during init: "Add agents to ~/.config/chant/config.md or .chant/agents.md"

### 2. Fix Config::load() to use merge semantics

Currently `Config::load()` ignores global config. Fix it:
- Make `Config::load()` call `load_merged()` internally
- Remove `load()` vs `load_merged()` distinction - always merge
- Global config (`~/.config/chant/config.md`) becomes the user config source

### 3. Support optional .chant/agents.md

For project-specific agent overrides (rare case):
- Check for `.chant/agents.md` (gitignored)
- Merge priority: `.chant/agents.md` > global > project
- Only for `parallel.agents` section

### 4. Update this repo

Move our own agents config out:
- Remove `parallel:` section from `.chant/config.md`
- Keep it in `~/.config/chant/config.md` (user's global config)
- Commit clean project config

### 5. Update documentation

- **CLAUDE.md**: Show agent config goes in global config
- **docs/reference/config.md**: Document the split
- Remove parallel.agents examples from project config docs

## Why This Works

✅ No external users - no breaking change impact
✅ Simpler than migration path
✅ Correct from the start
✅ Security: agents with API keys stay out of git
✅ Portability: each developer configures their own agents globally

## Acceptance Criteria

- [x] Remove parallel.agents from src/main.rs config template
- [x] Add agents.md to .chant/.gitignore template in src/main.rs
- [x] Make Config::load() use load_merged() semantics
- [x] Update all Config::load() callers if needed
- [x] Support .chant/agents.md for project-specific overrides
- [x] Remove parallel section from .chant/config.md in this repo
- [x] Update CLAUDE.md to document global agent config
- [x] Update docs/reference/config.md
- [x] All tests passing
- [x] Code linted and formatted