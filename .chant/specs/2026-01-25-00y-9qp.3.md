---
type: code
status: completed
depends_on:
- 2026-01-25-00y-9qp.2
target_files:
- src/cmd/spec.rs
- src/main.rs
model: claude-haiku-4-5-20251001
completed_at: 2026-01-25T00:00:00Z
commits:
- extraction-complete
---
# Extract spec commands to src/cmd/spec.rs

Move spec management commands into a dedicated module. These commands share common formatting utilities and spec display logic.

### Acceptance Criteria

- [x] All spec command functions moved to `src/cmd/spec.rs`:
  - [x] `cmd_add()`
  - [x] `cmd_list()`
  - [x] `cmd_show()`
  - [x] `cmd_ready()`
  - [x] `cmd_lint()`
  - [x] `cmd_status()`
  - [x] `cmd_delete()`
  - [x] `format_yaml_value()`
  - [x] `key_to_title_case()`
  - [x] All spec display/formatting utilities
  - [x] All execution functions (cmd_work, cmd_work_parallel, finalize_spec, etc)
  - [x] All git operations (create_or_switch_branch, push_branch)
  - [x] All model selection functions
  - [x] All transcript handling functions
  - [x] All split/archive/merge functions
- [x] Public API clearly defined with pub fn for each command
- [x] `src/main.rs` dispatches Commands::Add, Commands::List, etc. to `cmd::spec` functions
- [x] Helper formatting functions are private to cmd::spec
- [x] `just check` passes (cargo fmt, cargo clippy succeed)
- [x] Spec file parsing still works correctly (cmd::spec reads from spec files)
- [x] Tests pass for spec-related functions

### Edge Cases

- **Spec file I/O**: Ensure spec file reading/writing still works from new module location
- **Formatting consistency**: Verify YAML value formatting matches original output exactly
- **Label filtering**: Check that list filtering by labels still works correctly
- **Ready spec detection**: Verify `cmd_ready()` logic is fully migrated and dependency detection works

### Example Test Cases

For spec commands, verify:
- `cmd_list()` output format unchanged
- `cmd_show()` displays spec details identically to before
- `cmd_add()` creates new spec files in correct location
- Spec deletion works without leaving orphaned files
- Label filtering in list produces same results as before