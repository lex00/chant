---
type: code
status: in_progress
---
# Bug: MCP chant_spec_list includes archived specs by default

## Output

### Investigation Results

**Finding: The bug does not exist.** The MCP `chant_spec_list` tool is working correctly.

**Evidence:**

1. **MCP test**: Called `mcp__chant__chant_spec_list` and it returned 10 specs, all from `.chant/specs/`
2. **Actual counts**:
   - Specs in `.chant/specs/`: 10 files
   - Specs in `.chant/archive/`: 485 files
   - MCP returned: 10 specs (correct)
3. **Code verification**:
   - `mcp_ensure_initialized()` correctly returns `.chant/specs` path (src/mcp.rs:509)
   - `load_all_specs()` uses `load_specs_recursive()` which only recurses into subdirectories of the given path
   - Archive directory (`.chant/archive/`) is a sibling directory, not a subdirectory of `.chant/specs/`
4. **Test confirmation**: Created test `test_load_all_specs_excludes_archive` which passes, confirming archived specs are not loaded

**Conclusion:** No fix needed. The code is functioning as expected.

## Problem

The MCP `chant_spec_list` tool is returning archived specs when it should only return specs from `.chant/specs/`.

## Expected Behavior

- `chant_spec_list` should only return specs from `.chant/specs/`
- Archived specs in `.chant/archive/` should NOT be included

## Key Files

- `src/mcp.rs:524-572` - `tool_chant_spec_list()` function
- `src/mcp.rs:508-522` - `mcp_ensure_initialized()` returns `SPECS_DIR`
- `src/lib.rs:84` - `SPECS_DIR = ".chant/specs"`
- `src/lib.rs:90` - `ARCHIVE_DIR = ".chant/archive"`

## Investigation Needed

1. Verify the paths are correct (specs_dir should be `.chant/specs`)
2. Check if `load_all_specs()` is recursively loading from wrong directory
3. Test actual MCP output to confirm archived specs are included

## Acceptance Criteria

- [x] Identify why archived specs are being included
- [x] Fix so `chant_spec_list` only returns specs from `.chant/specs/`
- [x] Verify fix with test