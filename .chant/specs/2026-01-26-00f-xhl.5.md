---
type: code
status: pending
depends_on:
- 2026-01-26-00f-xhl.4
target_files:
- src/spec.rs
- src/replay.rs
---
# Add replay frontmatter tracking

Update spec frontmatter to track replay metadata: `replayed_at` timestamp, `replay_count` increment, and preserve `original_completed_at` from first completion. This provides audit trail for replays.

### Acceptance Criteria

- [ ] Adds `replayed_at` timestamp on successful replay
- [ ] Increments `replay_count` (initializes to 1 if first replay)
- [ ] Preserves `original_completed_at` from first completion
- [ ] Updates are atomic with replay execution success
- [ ] Frontmatter format remains valid YAML

### Edge Cases

- First replay: Should create all new fields (replayed_at, replay_count: 1, original_completed_at)
- Subsequent replays: Should increment count and update timestamp
- Spec never had completed_at: Should handle gracefully (shouldn't happen if validation works)
- Failed replay: Should not update any frontmatter fields

### Example Test Cases

For this feature, verify:
- After first replay: `replay_count: 1`, `replayed_at` set, `original_completed_at` preserved
- After second replay: `replay_count: 2`, `replayed_at` updated
- Failed replay leaves frontmatter unchanged
- Frontmatter parses correctly with new fields